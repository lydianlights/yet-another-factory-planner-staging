(this["webpackJsonpyet-another-factory-planner-client"]=this["webpackJsonpyet-another-factory-planner-client"]||[]).push([[0],{140:function(e,t,n){},178:function(e,t){},194:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(35),o=n.n(a),c=(n(140),n(9)),s=n(28),l=n(231),u=n(221),d=n(224),p=n(217),b=n(225),h=n(130),m=n(96),g=n(95),f=n.p+"static/media/satisfactory_logo_full_color_small.da5e9783.png",j=n(223),O=n(1),x=function(e){var t=e.href,n=e.icon;return Object(O.jsx)(y,{href:t,target:"_blank",rel:"noopener noreferrer",children:n||null})},y=Object(c.c)(j.a).withConfig({displayName:"SocialIcon__SAnchor",componentId:"sc-1yzxu05-0"})(["display:flex;align-items:center;justify-content:center;color:#f0f0f0;&:hover{color:#ddd;}"]),v="U6",w="factory",I=[{value:"U6",label:"Update 6 (Experimental)"},{value:"U5",label:"Update 5 (Stable)"}],T=n(3),k=n(15),C=n.n(k),E=n(25),_=n(4),S=n(120),D=n.n(S).a.create({baseURL:"https://lydian-satisfactory-planner-st.herokuapp.com/",responseType:"json"}),N=/:([a-zA-Z0-9-_]+)/g;function R(e,t){var n=Object(_.a)({},t);return{parsedURL:e.replace(N,(function(r,i){var a=t[i];return"string"===typeof a?(delete n[i],a):"number"===typeof a?(delete n[i],String(a)):(void 0===a?console.error("Error while parsing url ".concat(e,". No value provided for required parameter ").concat(r,".")):console.error("Error while parsing url ".concat(e,". Datatype provided for parameter ").concat(r," cannot be serialized.")),r)})),parsedData:n}}function A(e,t){return P.apply(this,arguments)}function P(){return(P=Object(E.a)(C.a.mark((function e(t,n){var r,i,a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=R(t,n||{}),i=r.parsedURL,a=r.parsedData,e.abrupt("return",D.request({method:"GET",url:i,params:a}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e,t){return L.apply(this,arguments)}function L(){return(L=Object(E.a)(C.a.mark((function e(t,n){var r,i,a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=R(t,n||{}),i=r.parsedURL,a=r.parsedData,e.abrupt("return",D.request({method:"POST",url:i,data:a}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){var t=Object(r.useRef)();return Object(r.useEffect)((function(){t.current=e}),[e]),t.current}function z(e){var t=Object(r.useState)(null),n=Object(T.a)(t,2),i=n[0],a=n[1],o=Object(r.useState)(null),c=Object(T.a)(o,2),s=c[0],l=c[1],u=Object(r.useState)(!1),d=Object(T.a)(u,2),p=d[0],b=d[1],h=U(p),m=Object(r.useCallback)(function(){var t=Object(E.a)(C.a.mark((function t(n){var r,i;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return b(!0),t.prev=1,t.next=4,e(n);case 4:r=t.sent,a(r),l(null),t.next=14;break;case 9:t.prev=9,t.t0=t.catch(1),i={status:t.t0.status||0,message:t.t0.message||"Unknown error"},a(null),l(i);case 14:return t.prev=14,b(!1),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[1,9,14,17]])})));return function(e){return t.apply(this,arguments)}}(),[]);return Object(r.useMemo)((function(){return{data:i,error:s,loading:p,completedThisFrame:!p&&!!h,request:m}}),[i,s,p,h,m])}var G=Object(r.createContext)(null);function F(){var e=Object(r.useContext)(G);if(!e)throw new Error("GameDataContext is null");return e}G.displayName="GameDataContext";var K=function(e){var t,n=e.children,i=Object(r.useState)(null),a=Object(T.a)(i,2),o=a[0],c=a[1],s=Object(r.useState)(""),l=Object(T.a)(s,2),u=l[0],d=l[1],p=Object(r.useState)(null),b=Object(T.a)(p,2),h=b[0],m=b[1],g=Object(r.useState)(!1),f=Object(T.a)(g,2),j=f[0],x=f[1],y=U(j),I=Object(r.useState)(!0),k=Object(T.a)(I,2),_=k[0],S=k[1],D=Object(r.useMemo)((function(){return!j&&j!==y}),[j,y]),N=z(function(){var e=Object(E.a)(C.a.mark((function e(t){var n,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A("/initialize",t);case 2:return n=e.sent,r=n.data,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),R=Object(r.useMemo)((function(){var e="";return u&&(e="[".concat(u,"] ")),e+"Yet Another Factory Planner"}),[u]);t=R,Object(r.useEffect)((function(){document.title=t}),[t]),Object(r.useEffect)((function(){if(_){var e,t;x(!0),S(!1),c(null),m(null);var n=new URLSearchParams(window.location.search),r=n.get(w),i=n.get("f"),a=null===(e=window.sessionStorage)||void 0===e?void 0:e.getItem("game-version"),o=null===(t=window.sessionStorage)||void 0===t?void 0:t.getItem("state");r?N.request({factoryKey:r}):i?N.request({gameVersion:"U5"}):a&&o?N.request({gameVersion:a}):N.request({gameVersion:u||v})}}),[_]),Object(r.useEffect)((function(){if(N.completedThisFrame){var e,t,n,r,i,a=(null===(e=N.data)||void 0===e?void 0:e.game_data)||null,o=(null===(t=N.data)||void 0===t?void 0:t.factory_config)||null,s=new URLSearchParams(window.location.search),l=s.get(w),p=s.get("f"),b=null===(n=window.sessionStorage)||void 0===n?void 0:n.getItem("game-version"),h=null;try{var g,f=null===(g=window.sessionStorage)||void 0===g?void 0:g.getItem("state");b&&f&&(h=JSON.parse(f))}catch(j){console.error(j)}window.history.replaceState(null,"","".concat(window.location.pathname)),null===(r=window.sessionStorage)||void 0===r||r.removeItem("game-version"),null===(i=window.sessionStorage)||void 0===i||i.removeItem("state"),(null===o||void 0===o?void 0:o.gameVersion)?d(o.gameVersion):d(p?"U5":b&&h?b:u||v),c(a),m({factoryConfig:o,shareKey:l,legacyEncoding:p,sessionState:h}),x(!1)}}),[N]);var P=Object(r.useCallback)((function(e){var t,n;e!==u&&(d(e),S(!0),null===(t=window.sessionStorage)||void 0===t||t.removeItem("game-version"),null===(n=window.sessionStorage)||void 0===n||n.removeItem("state"))}),[u]),M=Object(r.useMemo)((function(){return{gameData:o,initializer:h,loading:j,completedThisFrame:D,gameVersion:u,setGameVersion:P}}),[D,o,u,P,h,j]);return Object(O.jsx)(G.Provider,{value:M,children:n})},W=function(){var e=F();return Object(O.jsxs)(V,{fluid:!0,children:[Object(O.jsx)("img",{src:f,height:42,alt:"Satisfactory logo"}),Object(O.jsx)(B,{children:"[Yet Another Factory Planner]"}),Object(O.jsx)(H,{children:"(BETA)"}),Object(O.jsxs)(q,{children:[Object(O.jsx)(p.a,{"aria-label":"Game version",data:I,value:e.gameVersion,onChange:function(t){e.setGameVersion(t||v)},disabled:e.loading,style:{width:"200px"}}),Object(O.jsx)(x,{href:"https://github.com/lydianlights/yet-another-factory-planner",icon:Object(O.jsx)(m.a,{icon:g.b,fontSize:32})}),Object(O.jsx)(x,{href:"https://discord.gg/p7e9ZzRHCm",icon:Object(O.jsx)(m.a,{icon:g.a,fontSize:32})}),Object(O.jsx)(x,{href:"https://twitter.com/LydianLights",icon:Object(O.jsx)(m.a,{icon:g.c,fontSize:32})})]})]})},V=Object(c.c)(d.a).withConfig({displayName:"SiteHeader__HeaderContainer",componentId:"sc-tmk3hu-0"})(["display:flex;margin-left:",";padding:0px;"],(function(e){return e.theme.other.pageLeftMargin})),B=Object(c.c)(b.a).withConfig({displayName:"SiteHeader__MainTitle",componentId:"sc-tmk3hu-1"})(["position:relative;top:1px;font-size:32px;color:#fff;margin-left:25px;white-space:nowrap;font-family:'Indie Flower',sans-serif;"]),H=c.c.div.withConfig({displayName:"SiteHeader__BetaTag",componentId:"sc-tmk3hu-2"})(["position:relative;left:7px;top:3px;font-size:24px;color:#fff;font-family:'Fjalla One',sans-serif;transform:rotate(20deg);"]),q=Object(c.c)(h.a).withConfig({displayName:"SiteHeader__RightAlign",componentId:"sc-tmk3hu-3"})(["display:flex;margin-left:auto;margin-right:30px;"]),Z=n(90),Y=n(31),J=n(104),$=n(103),Q=n.p+"static/media/stripe-bg.ddc4de7e.png",X=n(202),ee=n(124),te=n.n(ee),ne=Object(r.createContext)(null);function re(){var e=Object(r.useContext)(ne);if(!e)throw new Error("GlobalContext is null");return e}ne.displayName="GlobalContext";var ie=["Pet the lizard doggo!","Get back to work!","Update 6 now available!","Arachnophobia mode enabled.","FICSIT does not waste.","Linear programming!","Do not pet the spiders.","Just slap some beams on it!","Just 5 more minutes...","Thanks, Jace. Helps a lot!","Thanks, Snutt. Helps a lot!","Check out the new Spire Coast!","ADA says it's my turn to play with the nuke nobelisk.","Harvest."];function ae(){var e=Math.floor((new Date).getTime()/18e5),t=te()(String(e)),n=Math.floor(t()*ie.length);return"FICSIT Tip #".concat(n,": ").concat(ie[n])}var oe=function(e){var t=e.children,n=Object(X.a)({key:"engineer-id",defaultValue:Math.floor(1e7*Math.random()).toString().padStart(7,"0")}),i=Object(T.a)(n,1)[0],a=Object(r.useState)(ae()),o=Object(T.a)(a,2),c=o[0],s=o[1],l=Object(r.useCallback)((function(){var e=ae();s(e)}),[]),u=Object(r.useMemo)((function(){return{ficsitTip:c,engineerId:i,refreshTip:l}}),[i,l,c]);return Object(O.jsx)(ne.Provider,{value:u,children:t})},ce=n(102),se=n.n(ce),le=n(59);function ue(e){try{return JSON.stringify(e)}catch(t){throw new Error("@mantine/hooks use-session-storage: Failed to serialize the value")}}function de(e){try{return JSON.parse(e)}catch(t){return e}}function pe(e){var t,n=e.key,i=e.defaultValue,a=void 0===i?void 0:i,o=e.getInitialValueInEffect,c=void 0!==o&&o,s=e.deserialize,l=void 0===s?de:s,u=e.serialize,d=void 0===u?ue:u,p=Object(r.useState)("undefined"!==typeof window&&"sessionStorage"in window&&!c?l(null!==(t=window.sessionStorage.getItem(n))&&void 0!==t?t:void 0):null!==a&&void 0!==a?a:""),b=Object(T.a)(p,2),h=b[0],m=b[1],g=Object(r.useCallback)((function(e){e instanceof Function?m((function(t){var r=e(t);return window.sessionStorage.setItem(n,d(r)),window.dispatchEvent(new CustomEvent("mantine-session-storage",{detail:{key:n,value:e(t)}})),r})):(window.sessionStorage.setItem(n,d(e)),window.dispatchEvent(new CustomEvent("mantine-session-storage",{detail:{key:n,value:e}})),m(e))}),[n]);return Object(le.a)("storage",(function(e){var t;e.storageArea===window.sessionStorage&&e.key===n&&m(l(null!==(t=e.newValue)&&void 0!==t?t:void 0))})),Object(le.a)("mantine-session-storage",(function(e){e.detail.key===n&&m(e.detail.value)})),Object(r.useEffect)((function(){void 0!==a&&void 0===h&&g(a)}),[a,h,g]),Object(r.useEffect)((function(){var e;c&&m(l(null!==(e=window.sessionStorage.getItem(n))&&void 0!==e?e:void 0)||(null!==a&&void 0!==a?a:""))}),[]),[void 0===h?a:h,g]}var be=n(2),he=n(13),me=n(56),ge=n(84),fe=n(125),je=n(18),Oe=n(85),xe=n(91),ye=n(131),ve=function(e){Object(Oe.a)(n,e);var t=Object(xe.a)(n);function n(e,r){var i;return Object(me.a)(this,n),(i=t.call(this,e)).helpText=void 0,i.helpText=r,i}return n}(Object(ye.a)(Error)),we=1e-8,Ie=1e5,Te="RATE_TARGET_PASS",ke="FINAL_PRODUCT",Ce="SIDE_PRODUCT",Ee="INPUT_ITEM",_e="HAND_GATHERED_RESOURCE",Se="RESOURCE",De="RECIPE",Ne="POINTS_ITEM_KEY",Re=function(){function e(t,n){var r=this;Object(me.a)(this,e),this.gameData=void 0,this.globalWeights=void 0,this.inputs=void 0,this.rateTargets=void 0,this.maximizeTargets=void 0,this.hasPointsTarget=void 0,this.allowedRecipes=void 0,this.allowedItems=void 0,this.scale=void 0,this.gameData=n,this.allowedRecipes=t.allowedRecipes,this.allowedItems={},Object.entries(this.allowedRecipes).forEach((function(e){var t=Object(T.a)(e,2),n=t[0];if(t[1]){var i=r.gameData.recipes[n];i.ingredients.forEach((function(e){r.allowedItems[e.itemClass]=!0})),i.products.forEach((function(e){r.allowedItems[e.itemClass]=!0}))}})),this.globalWeights={resources:Number(t.weightingOptions.resources),power:Number(t.weightingOptions.power),complexity:Number(t.weightingOptions.complexity),buildings:Number(t.weightingOptions.buildings)},this.validateNumber(this.globalWeights.resources),this.validateNumber(this.globalWeights.power),this.validateNumber(this.globalWeights.complexity),this.validateNumber(this.globalWeights.buildings);var i=Math.max(this.globalWeights.resources,this.globalWeights.power,this.globalWeights.complexity,this.globalWeights.buildings);this.globalWeights.resources=this.globalWeights.resources/i+1e-4,this.globalWeights.power=this.globalWeights.power/i,this.globalWeights.complexity=this.globalWeights.complexity/i*1e3,this.globalWeights.buildings=this.globalWeights.buildings/i,this.inputs={},t.inputResources.forEach((function(e){if(r.gameData.resources[e.itemKey]){var t=e.unlimited?1/0:Number(e.value);if(r.validateNumber(t),t){var n=Number(e.weight);r.validateNumber(n),r.inputs[e.itemKey]={amount:t,weight:n,type:Se}}}}));var a=Math.max.apply(Math,Object(he.a)(Object.values(this.inputs).map((function(e){return e.weight}))));Object.values(this.inputs).forEach((function(e){e.weight/=a})),t.inputItems.forEach((function(e){if(e.itemKey){var t=e.unlimited?1/0:Number(e.value);r.validateNumber(t),t&&(r.inputs[e.itemKey]?r.inputs[e.itemKey].amount+=t:r.inputs[e.itemKey]={amount:t,weight:0,type:Ee})}})),t.allowHandGatheredItems&&Object.keys(this.gameData.handGatheredItems).forEach((function(e){r.inputs[e]={amount:1/0,weight:1e3,type:_e}})),this.inputs.Desc_Gift_C={amount:1/0,weight:1e3,type:_e},this.rateTargets={},this.maximizeTargets=[],this.hasPointsTarget=!1,this.scale=0;var o={},c={};if(t.productionItems.forEach((function(e){if(e.itemKey){var t=Number(e.value);if(r.validateNumber(t),t){if(r.inputs[e.itemKey])throw new ve("INVALID INPUT","You can't set the same item as both an input and an output. Double check your factory settings.");var n=e.itemKey===Ne;switch(n&&(r.hasPointsTarget=!0),e.mode){case"per-minute":r.scale+=t,o[e.itemKey]?o[e.itemKey].value+=t:o[e.itemKey]={value:t,recipe:null,isPoints:n};break;case"maximize":var i=r.maximizeTargets.find((function(t){return t.key===e.itemKey}));i?i.priority<t&&(i.priority=t):r.maximizeTargets.push({key:e.itemKey,priority:t});break;default:var a=e.mode,s=r.gameData.recipes[a];if(!s)throw new ve("INVALID OUTPUT MODE SELECTION","Something really broke... Try refreshing or resetting your factory.");if(!r.allowedRecipes[a])throw new ve("CANNOT TARGET DISABLED RECIPE","Make sure the recipe you are targeting is enabled in the Recipes tab.");var l=s.products.find((function(t){return t.itemClass===e.itemKey}));r.scale+=l.perMinute*t,o[e.itemKey]?o[e.itemKey].value+=l.perMinute*t:o[e.itemKey]={value:l.perMinute*t,recipe:null,isPoints:!1},c[a]?c[a].value+=t:c[a]={value:t,recipe:a,isPoints:!1}}}}})),0===this.scale&&(this.scale=1),this.maximizeTargets.sort((function(e,t){if(e.priority>t.priority)return-1;if(e.priority<t.priority)return 1;throw new ve("DUPLICATE MAXIMIZATION PRIORITY","Two items have the same maximization priority, which is currently not allowed.")})),this.rateTargets=Object(_.a)(Object(_.a)({},o),c),0===Object.keys(this.rateTargets).length&&0===this.maximizeTargets.length)throw new ve("NO OUTPUTS SET","Open the control panel to get started.")}return Object(ge.a)(e,[{key:"validateNumber",value:function(e){if(Number.isNaN(e))throw new ve("INVALID VALUE: NOT A NUMBER","Double check your factory settings.");if(e<0)throw new ve("INVALID VALUE: NEGATIVE NUMBER","Double check your factory settings.")}},{key:"exec",value:function(){var e=Object(E.a)(C.a.mark((function e(){var t,n,r,i,a,o,c,s,l,u,d,p,b,h,m,g,f,j;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=performance.now(),e.prev=1,e.next=4,Object(fe.a)();case 4:return n=e.sent,e.next=7,this.productionSolverPass(Te,this.inputs,n);case 7:r=e.sent,i=this.generateProductionGraph(r),a=Object(be.a)(this.maximizeTargets),e.prev=10,a.s();case 12:if((o=a.n()).done){e.next=24;break}for(c=o.value,s={},l=function(){var e=Object(T.a)(d[u],2),t=e[0],n=e[1],r=Object.values(i.nodes).find((function(e){return e.key===t})),a=0;r&&(a=r.multiplier);var o=n.amount-a;o>we&&(s[t]=Object(_.a)(Object(_.a)({},n),{},{amount:o}))},u=0,d=Object.entries(this.inputs);u<d.length;u++)l();return e.next=19,this.productionSolverPass(c.key,s,n);case 19:for(p=e.sent,b=0,h=Object.entries(p);b<h.length;b++)m=Object(T.a)(h[b],2),g=m[0],f=m[1],r[g]?r[g]+=f:r[g]=f;i=this.generateProductionGraph(r);case 22:e.next=12;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(10),a.e(e.t0);case 29:return e.prev=29,a.f(),e.finish(29);case 32:if(0!==Object.keys(i.nodes).length){e.next=34;break}throw new ve("SOLUTION IS EMPTY","For some reason the solution for your parameters is an empty factory. Double check that your factory settings make sense.");case 34:return j=this.generateProductionReport(i),e.abrupt("return",{productionGraph:i,report:j,timestamp:t,computeTime:performance.now()-t,error:null});case 38:return e.prev=38,e.t1=e.catch(1),e.abrupt("return",{productionGraph:null,report:null,timestamp:t,computeTime:performance.now()-t,error:e.t1});case 41:case"end":return e.stop()}}),e,this,[[1,38],[10,26,29,32]])})));return function(){return e.apply(this,arguments)}}()},{key:"getItemPoints",value:function(e){var t=this.gameData.items[e];return t.isFicsmas?0:t.sinkPoints}},{key:"productionSolverPass",value:function(){var e=Object(E.a)(C.a.mark((function e(t,n,r){var i,a,o,c,s,l,u,d,p,b,h,m,g,f,j,O,x,y,v,w,I,k,E,_,S,D,N,R,A,P,M,L,U,z,G,F,K,W,V,B=this;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i={name:"production",objective:{name:"score",direction:r.GLP_MIN,vars:[]},subjectTo:[],binaries:[]},a=t===Te&&this.rateTargets.POINTS_ITEM_KEY||t===Ne,o=[],c=0,s=Object.entries(this.gameData.recipes);case 4:if(!(c<s.length)){e.next=20;break}if(l=Object(T.a)(s[c],2),u=l[0],d=l[1],this.allowedRecipes[u]){e.next=8;break}return e.abrupt("continue",17);case 8:p=this.gameData.buildings[d.producedIn],b=p.power>0?p.power*this.globalWeights.power:0,h=this.globalWeights.buildings,m=0,g=Object(be.a)(d.ingredients);try{for(g.s();!(f=g.n()).done;)j=f.value,(O=this.inputs[j.itemClass])&&(m+=O.weight*j.perMinute*this.globalWeights.resources)}catch(C){g.e(C)}finally{g.f()}if(i.objective.vars.push({name:u,coef:b+m+h}),t===Te&&this.rateTargets[u]&&i.subjectTo.push({name:"".concat(u," recipe constraint"),vars:[{name:u,coef:1}],bnds:{type:r.GLP_LO,ub:0,lb:this.rateTargets[u].value}}),a){x=0,y=Object(be.a)(d.products);try{for(y.s();!(v=y.n()).done;)w=v.value,this.inputs[w.itemClass]&&this.inputs[w.itemClass].type!==Ee||(x-=w.perMinute*this.getItemPoints(w.itemClass)/1e3)}catch(C){y.e(C)}finally{y.f()}I=Object(be.a)(d.ingredients);try{for(I.s();!(k=I.n()).done;)E=k.value,this.inputs[E.itemClass]&&this.inputs[E.itemClass].type!==Ee||(x+=E.perMinute*this.getItemPoints(E.itemClass)/1e3)}catch(C){I.e(C)}finally{I.f()}o.push({name:u,coef:x})}case 17:c++,e.next=4;break;case 20:if(a){for(_=0,S=0,D=Object.entries(n);S<D.length;S++)N=Object(T.a)(D[S],2),R=N[0],(A=N[1]).type===Ee&&(_+=this.getItemPoints(R)*A.amount);if(t===Te){for(P=0,M=Object.entries(this.rateTargets);P<M.length;P++)L=Object(T.a)(M[P],2),U=L[0],z=L[1],U!==Ne&&(_-=this.getItemPoints(U)*z.value);i.subjectTo.push({name:"AWESOME Sink Points constraint",vars:o,bnds:{type:r.GLP_UP,ub:-this.rateTargets.POINTS_ITEM_KEY.value-_,lb:NaN}})}else t===Ne&&o.forEach((function(e){var t=i.objective.vars.find((function(t){return t.name===e.name}));t?t.coef+=e.coef*Ie:i.objective.vars.push({name:e.name,coef:e.coef*Ie})}))}G=function(){var e=Object(T.a)(K[F],2),a=e[0],o=e[1];if(!B.allowedItems[a])return"continue";var c,s=[],l="".concat(a,"_BIN"),u=[],d=Object(be.a)(o.usedInRecipes);try{for(d.s();!(c=d.n()).done;){var p=c.value;if(B.allowedRecipes[p]){var b=B.gameData.recipes[p].ingredients.find((function(e){return e.itemClass===a}));s.push({name:p,coef:b.perMinute}),B.gameData.handGatheredItems[a]||u.push({name:p,coef:-1})}}}catch(C){d.e(C)}finally{d.f()}var h,m=Object(be.a)(o.producedFromRecipes);try{var g=function(){var e=h.value;if(!B.allowedRecipes[e])return"continue";var t=B.gameData.recipes[e].products.find((function(e){return e.itemClass===a})),n=s.find((function(t){return t.name===e}));n?n.coef-=t.perMinute:s.push({name:e,coef:-t.perMinute})};for(m.s();!(h=m.n()).done;)g()}catch(C){m.e(C)}finally{m.f()}if(t===Te&&B.globalWeights.complexity>0&&u.length>0&&(i.binaries.push(l),i.objective.vars.push({name:l,coef:B.globalWeights.complexity}),i.subjectTo.push({name:"".concat(l," constraint"),vars:[{name:l,coef:1e3*Math.sqrt(B.scale)}].concat(u),bnds:{type:r.GLP_LO,ub:NaN,lb:0}})),0===s.length)return"continue";if(n[a]){var f=n[a];f.amount!==1/0&&i.subjectTo.push({name:"".concat(a," resource constraint"),vars:s,bnds:{type:r.GLP_UP,ub:f.amount,lb:NaN}})}else if(t===Te&&B.rateTargets[a]){var j=B.rateTargets[a];i.subjectTo.push({name:"".concat(a," final product constraint"),vars:s,bnds:{type:r.GLP_UP,ub:-j.value,lb:NaN}})}else t===a?(i.subjectTo.push({name:"".concat(a," final product constraint"),vars:s,bnds:{type:r.GLP_UP,ub:0,lb:NaN}}),s.forEach((function(e){var t=i.objective.vars.find((function(t){return t.name===e.name}));t?t.coef+=e.coef*Ie:i.objective.vars.push({name:e.name,coef:e.coef*Ie})}))):i.subjectTo.push({name:"".concat(a," intermediates constraint"),vars:s,bnds:{type:r.GLP_UP,ub:0,lb:NaN}})},F=0,K=Object.entries(this.gameData.items);case 23:if(!(F<K.length)){e.next=30;break}if("continue"!==G()){e.next=27;break}return e.abrupt("continue",27);case 27:F++,e.next=23;break;case 30:return e.next=32,r.solve(i,{msglev:r.GLP_MSG_OFF,tmlim:3});case 32:if(!((W=e.sent).time>3)){e.next=35;break}throw new ve("TIMED OUT","Try setting the complexity weight to 0. Unfortunately it is currently very slow for large factories. For complex factories, you might try the Buildings optimizer instead.");case 35:if(W.result.status===r.GLP_OPT||W.result.status===r.GLP_FEAS){e.next=41;break}if(t!==Te){e.next=40;break}throw new ve("NO SOLUTION","This could be due to missing recipes, impossible demands, or any number of reasons. Double check your factory settings.");case 40:throw new ve("SOLUTION IS UNBOUNDED","Somehow an infinite amount of items can be produced. Double check the inputs tab for infinite resources (including the hand gathered resources option).");case 41:return V={},Object.entries(W.result.vars).forEach((function(e){var t=Object(T.a)(e,2),n=t[0],r=t[1];r>we&&B.gameData.recipes[n]&&(V[n]=r)})),e.abrupt("return",V);case 44:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"generateProductionGraph",value:function(e){for(var t=this,n={},r={nodes:{},edges:[]},i=0,a=Object.entries(e);i<a.length;i++){var o,c=Object(T.a)(a[i],2),s=c[0],l=c[1],u=this.gameData.recipes[s],d=Object(be.a)(u.products);try{for(d.s();!(o=d.n()).done;){var p=o.value,b=l*p.perMinute;n[p.itemClass]||(n[p.itemClass]={producedBy:[],usedBy:[]}),n[p.itemClass].producedBy.push({recipeKey:s,amount:b})}}catch(y){d.e(y)}finally{d.f()}var h,m=Object(be.a)(u.ingredients);try{for(m.s();!(h=m.n()).done;){var g=h.value,f=l*g.perMinute;n[g.itemClass]||(n[g.itemClass]={producedBy:[],usedBy:[]}),n[g.itemClass].usedBy.push({recipeKey:s,amount:f})}}catch(y){m.e(y)}finally{m.f()}r.nodes[s]={id:Object(je.a)(),key:s,type:De,multiplier:l}}for(var j=function(){var e=Object(T.a)(x[O],2),n=e[0],i=e[1],a=i.producedBy,o=i.usedBy,c=0,s=0;e:for(;c<o.length;){for(var l=o[c],u=r.nodes[l.recipeKey];s<a.length;){var d,p=a[s],b=r.nodes[p.recipeKey],h=null===(d=t.rateTargets[n])||void 0===d?void 0:d.recipe;if(h&&h===p.recipeKey){var m=t.rateTargets[n],g=t.gameData.recipes[h].products.find((function(e){return e.itemClass===n})),f=m.value*g.perMinute;p.amount-=f;var j=r.nodes[n];j?r.nodes[n].multiplier+=f:(j={id:Object(je.a)(),key:n,type:ke,multiplier:f},r.nodes[n]=j),r.edges.push({key:n,from:b.id,to:j.id,productionRate:f})}if(p.amount<we)s++;else{if(l.amount<=p.amount?(r.edges.push({key:n,from:b.id,to:u.id,productionRate:l.amount}),p.amount-=l.amount,l.amount=0):(r.edges.push({key:n,from:b.id,to:u.id,productionRate:p.amount}),l.amount-=p.amount,p.amount=0),l.amount<we){c++;continue e}s++}}break}for(;c<o.length;){var y=o[c],v=r.nodes[y.recipeKey];if(y.amount>we&&t.inputs[n]){var w=r.nodes[n];if(w)w.multiplier+=y.amount;else{var I=t.inputs[n];w={id:Object(je.a)(),key:n,type:I.type,multiplier:y.amount},r.nodes[n]=w}r.edges.push({key:n,from:w.id,to:v.id,productionRate:y.amount}),y.amount=0}c++}for(;s<a.length;){var k=a[s],C=r.nodes[k.recipeKey];if(k.amount>we){var E=r.nodes[n];if(E)E.multiplier+=k.amount;else{var _=Ce;(t.rateTargets[n]||t.maximizeTargets.find((function(e){return e.key===n}))||t.hasPointsTarget&&t.getItemPoints(n)>0)&&(_=ke),E={id:Object(je.a)(),key:n,type:_,multiplier:k.amount},r.nodes[n]=E}r.edges.push({key:n,from:C.id,to:E.id,productionRate:k.amount}),k.amount=0}s++}},O=0,x=Object.entries(n);O<x.length;O++)j();return r}},{key:"generateProductionReport",value:function(e){for(var t={pointsProduced:0,powerUsageEstimate:{production:0,extraction:0,generators:0,total:0},resourceEfficiencyScore:0,totalBuildArea:0,estimatedFoundations:0,buildingsUsed:{},totalMaterialCost:{}},n=0,r=Object.entries(e.nodes);n<r.length;n++){var i=Object(T.a)(r[n],2),a=i[0],o=i[1];if(o.type!==De){if(o.type===ke)t.pointsProduced+=o.multiplier*this.getItemPoints(a);else if(o.type===Se){t.resourceEfficiencyScore+=o.multiplier*this.inputs[a].weight;var c=0;if("Desc_Water_C"===a){c=o.multiplier/120*this.gameData.buildings.Desc_WaterPump_C.power;var s=Math.ceil(o.multiplier/120);t.buildingsUsed.Desc_WaterPump_C={count:s,materialCost:{}};var l,u=Object(be.a)(this.gameData.buildings.Desc_WaterPump_C.buildCost);try{for(u.s();!(l=u.n()).done;){var d=l.value,p=s*d.quantity;t.buildingsUsed.Desc_WaterPump_C.materialCost[d.itemClass]=p,t.totalMaterialCost[d.itemClass]?t.totalMaterialCost[d.itemClass]+=p:t.totalMaterialCost[d.itemClass]=p}}catch(x){u.e(x)}finally{u.f()}}else"Desc_LiquidOil_C"===a?c=o.multiplier/120*this.gameData.buildings.Desc_OilPump_C.power:"Desc_NitrogenGas_C"===a||(c=o.multiplier/240*this.gameData.buildings.Desc_MinerMk3_C.power);t.powerUsageEstimate.extraction+=c,t.powerUsageEstimate.total+=c}}else{var b=this.gameData.recipes[a].producedIn,h=this.gameData.buildings[b],m=o.multiplier*h.power;m<0?t.powerUsageEstimate.generators+=-m:t.powerUsageEstimate.production+=m,t.powerUsageEstimate.total+=m,t.totalBuildArea+=Math.ceil(o.multiplier)*h.area,t.buildingsUsed[b]?t.buildingsUsed[b].count+=Math.ceil(o.multiplier):t.buildingsUsed[b]={count:Math.ceil(o.multiplier),materialCost:{}};var g,f=Object(be.a)(h.buildCost);try{for(f.s();!(g=f.n()).done;){var j=g.value,O=Math.ceil(o.multiplier)*j.quantity;t.buildingsUsed[b].materialCost[j.itemClass]?t.buildingsUsed[b].materialCost[j.itemClass]+=O:t.buildingsUsed[b].materialCost[j.itemClass]=O,t.totalMaterialCost[j.itemClass]?t.totalMaterialCost[j.itemClass]+=O:t.totalMaterialCost[j.itemClass]=O}}catch(x){f.e(x)}finally{f.f()}}}return t.estimatedFoundations=Math.ceil(t.totalBuildArea/64*2),t}}]),e}();var Ae=":";function Pe(e,t){if("points"===e)return Ne;var n=Object.entries(t).find((function(t){var n=Object(T.a)(t,2);n[0];return n[1].slug===e}));if(n)return n[0];throw new Error("INVALID ITEM SLUG")}function Me(e,t){if("per_minute"===e)return"per-minute";if("maximize"===e)return"maximize";var n=Object.entries(t).find((function(t){var n=Object(T.a)(t,2);n[0];return n[1].slug===e}));if(n)return n[0];throw new Error("INVALID RECIPE SLUG")}var Le=":";function Ue(e,t){if("points"===e)return Ne;var n=Object.entries(t).find((function(t){var n=Object(T.a)(t,2);n[0];return n[1].slug===e}));if(n)return n[0];throw new Error("INVALID ITEM SLUG")}function ze(e,t){if("per_minute"===e)return"per-minute";if("maximize"===e)return"maximize";var n=Object.entries(t).find((function(t){var n=Object(T.a)(t,2);n[0];return n[1].slug===e}));if(n)return n[0];throw new Error("INVALID RECIPE SLUG")}var Ge=":";function Fe(e,t){if("points"===e)return Ne;var n=Object.entries(t).find((function(t){var n=Object(T.a)(t,2);n[0];return n[1].slug===e}));if(n)return n[0];throw new Error("INVALID ITEM SLUG")}function Ke(e,t){if("per_minute"===e)return"per-minute";if("maximize"===e)return"maximize";var n=Object.entries(t).find((function(t){var n=Object(T.a)(t,2);n[0];return n[1].slug===e}));if(n)return n[0];throw new Error("INVALID RECIPE SLUG")}function We(){return{key:Object(je.a)(),itemKey:"",mode:"per-minute",value:"10"}}function Ve(){return{key:Object(je.a)(),itemKey:"",value:"10",weight:"0",unlimited:!1}}var Be=["Desc_OreIron_C","Desc_OreCopper_C","Desc_Stone_C","Desc_Coal_C","Desc_OreGold_C","Desc_RawQuartz_C","Desc_Sulfur_C","Desc_LiquidOil_C","Desc_OreBauxite_C","Desc_OreUranium_C","Desc_NitrogenGas_C","Desc_Water_C"];function He(e){return Object.entries(e).map((function(e){var t=Object(T.a)(e,2),n=t[0],r=t[1],i="0",a=!1;return"Desc_Water_C"===n?a=!0:i=String(r.maxExtraction),{key:n,itemKey:n,value:i,weight:String(r.relativeValue),unlimited:a}})).sort((function(e,t){var n=Be.findIndex((function(t){return t===e.itemKey}));-1===n&&(n=1/0);var r=Be.findIndex((function(e){return e===t.itemKey}));return-1===r&&(r=1/0),n<r?-1:1}))}function qe(e){var t={};return Object.entries(e).forEach((function(e){var n=Object(T.a)(e,2),r=n[0],i=n[1];t[r]=!i.isAlternate})),t}function Ze(e){return{key:Object(je.a)(),productionItems:[],inputItems:[],inputResources:He(e.resources),allowHandGatheredItems:!1,weightingOptions:{resources:"1000",power:"1",complexity:"0",buildings:"0"},allowedRecipes:qe(e.recipes)}}function Ye(e,t){switch(t.type){case"RESET_FACTORY":return Ze(t.gameData);case"ADD_PRODUCTION_ITEM":var n=[].concat(Object(he.a)(e.productionItems),[We()]);return Object(_.a)(Object(_.a)({},e),{},{productionItems:n});case"DELETE_PRODUCTION_ITEM":var r=e.productionItems.filter((function(e){return e.key!==t.key}));return Object(_.a)(Object(_.a)({},e),{},{productionItems:r});case"SET_PRODUCTION_ITEM":var i=e.productionItems.map((function(e){var n;return e.key===t.data.key?((n="per-minute"===e.mode||"maximize"===e.mode?Object(_.a)({},e):We()).itemKey=t.data.itemKey,n):e}));return Object(_.a)(Object(_.a)({},e),{},{productionItems:i});case"SET_PRODUCTION_ITEM_AMOUNT":var a=e.productionItems.map((function(e){if(e.key===t.data.key){var n=Object(_.a)({},e);return n.value=t.data.amount,n}return e}));return Object(_.a)(Object(_.a)({},e),{},{productionItems:a});case"SET_PRODUCTION_ITEM_MODE":var o=e.productionItems.map((function(n){if(n.key===t.data.key){var r=Object(_.a)({},n);return r.mode=t.data.mode,r.mode!==n.mode&&("per-minute"===r.mode?r.value="10":"maximize"===r.mode?function(){for(var t=20;t&&t>0;){if(!!!e.productionItems.find((function(e){return"maximize"===e.mode&&e.value===String(t)})))break;t--}r.value=t>0?String(t):"".concat(20)}():"per-minute"!==n.mode&&"maximize"!==n.mode||(r.value="1")),r}return n}));return Object(_.a)(Object(_.a)({},e),{},{productionItems:o});case"ADD_INPUT_ITEM":var c=[].concat(Object(he.a)(e.inputItems),[Ve()]);return Object(_.a)(Object(_.a)({},e),{},{inputItems:c});case"DELETE_INPUT_ITEM":var s=e.inputItems.filter((function(e){return e.key!==t.key}));return Object(_.a)(Object(_.a)({},e),{},{inputItems:s});case"UPDATE_INPUT_ITEM":var l=e.inputItems.map((function(e){return e.key===t.data.key?t.data:e}));return Object(_.a)(Object(_.a)({},e),{},{inputItems:l});case"UPDATE_INPUT_RESOURCE":var u=e.inputResources.map((function(e){return e.key===t.data.key?t.data:e}));return Object(_.a)(Object(_.a)({},e),{},{inputResources:u});case"SET_RESOURCES_TO_MAP_LIMITS":var d=He(t.gameData.resources);return Object(_.a)(Object(_.a)({},e),{},{inputResources:d});case"SET_RESOURCES_TO_0":var p=e.inputResources.map((function(e){return Object(_.a)(Object(_.a)({},e),{},{value:"0",unlimited:!1})}));return Object(_.a)(Object(_.a)({},e),{},{inputResources:p});case"SET_ALLOW_HAND_GATHERED_ITEMS":return Object(_.a)(Object(_.a)({},e),{},{allowHandGatheredItems:t.active});case"UPDATE_WEIGHTING_OPTIONS":var b=Object(_.a)({},t.data);return Object(_.a)(Object(_.a)({},e),{},{weightingOptions:b});case"SET_ALL_WEIGHTS_DEFAULT":var h={resources:"1000",power:"1",complexity:"0",buildings:"0"},m=e.inputResources.map((function(e){return Object(_.a)(Object(_.a)({},e),{},{weight:String(t.gameData.resources[e.itemKey].relativeValue)})}));return Object(_.a)(Object(_.a)({},e),{},{weightingOptions:h,inputResources:m});case"SET_RECIPE_ACTIVE":var g=Object(_.a)({},e.allowedRecipes);return g[t.key]=t.active,Object(_.a)(Object(_.a)({},e),{},{allowedRecipes:g});case"MASS_SET_RECIPES_ACTIVE":var f=Object(_.a)({},e.allowedRecipes);return t.recipes.forEach((function(e){f[e]=t.active})),Object(_.a)(Object(_.a)({},e),{},{allowedRecipes:f});case"LOAD_FROM_SHARED_FACTORY":try{var j=Ze(t.gameData);return j.productionItems=t.config.productionItems.map((function(e){return Object(_.a)(Object(_.a)({},We()),{},{itemKey:e.itemKey,mode:e.mode,value:String(e.value)})})),j.inputItems=t.config.inputItems.map((function(e){return Object(_.a)(Object(_.a)({},Ve()),{},{itemKey:e.itemKey,value:String(e.value),weight:String(e.weight),unlimited:e.unlimited})})),j.inputResources.forEach((function(e){var n=t.config.inputResources.find((function(t){return e.itemKey===t.itemKey}));e.value=String(n.value),e.weight=String(n.weight),e.unlimited=n.unlimited})),j.allowHandGatheredItems=t.config.allowHandGatheredItems,j.weightingOptions.resources=String(t.config.weightingOptions.resources),j.weightingOptions.power=String(t.config.weightingOptions.power),j.weightingOptions.complexity=String(t.config.weightingOptions.complexity),j.weightingOptions.buildings=String(t.config.weightingOptions.buildings),t.config.allowedRecipes.forEach((function(e){null!=j.allowedRecipes[e]&&(j.allowedRecipes[e]=!0)})),j}catch(O){return console.error(O),Ze(t.gameData)}case"LOAD_FROM_LEGACY_ENCODING":try{return function(e,t){var n=e.substring(0,5);if("v1_U5"===n)return function(e,t){var n=Ze(t),r=e.split(",");if("v1_U5"!==r[0])throw new Error("VERSION MISMATCH");if(7!==r.length)throw new Error("INVALID DATA [BAD FIELDS]");var i=Object.keys(n.allowedRecipes).filter((function(e){return!t.recipes[e].isFicsmas||(n.allowedRecipes[e]=!1,!1)})),a=BigInt("0x".concat(r[1])).toString(2).padStart(i.length,"0").split("").map((function(e){return!!parseInt(e)}));i.sort((function(e,t){return e<t?-1:e>t?1:0})).forEach((function(e,t){n.allowedRecipes[e]=!!a[t]}));var o=r[2].split("|");o[0]&&o.forEach((function(e){var r=e.split(Ae);if(3!==r.length)throw new Error("INVALID DATA [productionItems]");n.productionItems.push({key:Object(je.a)(),itemKey:Pe(r[0],t.items),mode:Me(r[1],t.recipes),value:r[2]})}));var c=r[3].split("|");c[0]&&c.forEach((function(e){var r=e.split(Ae);if(4!==r.length)throw new Error("INVALID DATA [inputItems]");n.inputItems.push({key:Object(je.a)(),itemKey:Pe(r[0],t.items),value:r[1],weight:r[2],unlimited:!!parseInt(r[3])})}));var s=r[4].split("|");n.inputResources.forEach((function(e,t){var n=s[t].split(Ae);if(3!==n.length)throw new Error("INVALID DATA [inputResources]");e.value=n[0],e.weight=n[1],e.unlimited=!!parseInt(n[2])})),n.allowHandGatheredItems=!!parseInt(r[5]);var l=r[6].split(Ae);if(3!==l.length)throw new Error("INVALID DATA [weightingOptions]");return n.weightingOptions.resources=l[0],n.weightingOptions.power=l[1],n.weightingOptions.complexity=l[2],n.weightingOptions.buildings="0",n}(e,t);if("v2_U5"===n)return function(e,t){var n=Ze(t),r=e.split(",");if("v2_U5"!==r[0])throw new Error("VERSION MISMATCH");if(7!==r.length)throw new Error("INVALID DATA [BAD FIELDS]");var i=BigInt("0x".concat(r[1])).toString(2).padStart(Object.keys(n.allowedRecipes).length,"0").split("").map((function(e){return!!parseInt(e)}));Object.keys(n.allowedRecipes).sort((function(e,t){return e<t?-1:e>t?1:0})).forEach((function(e,t){n.allowedRecipes[e]=!!i[t]}));var a=r[2].split("|");a[0]&&a.forEach((function(e){var r=e.split(Le);if(3!==r.length)throw new Error("INVALID DATA [productionItems]");n.productionItems.push({key:Object(je.a)(),itemKey:Ue(r[0],t.items),mode:ze(r[1],t.recipes),value:r[2]})}));var o=r[3].split("|");o[0]&&o.forEach((function(e){var r=e.split(Le);if(4!==r.length)throw new Error("INVALID DATA [inputItems]");n.inputItems.push({key:Object(je.a)(),itemKey:Ue(r[0],t.items),value:r[1],weight:r[2],unlimited:!!parseInt(r[3])})}));var c=r[4].split("|");n.inputResources.forEach((function(e,t){var n=c[t].split(Le);if(3!==n.length)throw new Error("INVALID DATA [inputResources]");e.value=n[0],e.weight=n[1],e.unlimited=!!parseInt(n[2])})),n.allowHandGatheredItems=!!parseInt(r[5]);var s=r[6].split(Le);if(3!==s.length)throw new Error("INVALID DATA [weightingOptions]");return n.weightingOptions.resources=s[0],n.weightingOptions.power=s[1],n.weightingOptions.complexity=s[2],n.weightingOptions.buildings="0",n}(e,t);if("v3_U5"===n)return function(e,t){var n=Ze(t),r=e.split(",");if("v3_U5"!==r[0])throw new Error("VERSION MISMATCH");if(7!==r.length)throw new Error("INVALID DATA [BAD FIELDS]");var i=BigInt("0x".concat(r[1])).toString(2).padStart(Object.keys(n.allowedRecipes).length,"0").split("").map((function(e){return!!parseInt(e)}));Object.keys(n.allowedRecipes).sort((function(e,t){return e<t?-1:e>t?1:0})).forEach((function(e,t){n.allowedRecipes[e]=!!i[t]}));var a=r[2].split("|");a[0]&&a.forEach((function(e){var r=e.split(Ge);if(3!==r.length)throw new Error("INVALID DATA [productionItems]");n.productionItems.push({key:Object(je.a)(),itemKey:Fe(r[0],t.items),mode:Ke(r[1],t.recipes),value:r[2]})}));var o=r[3].split("|");o[0]&&o.forEach((function(e){var r=e.split(Ge);if(4!==r.length)throw new Error("INVALID DATA [inputItems]");n.inputItems.push({key:Object(je.a)(),itemKey:Fe(r[0],t.items),value:r[1],weight:r[2],unlimited:!!parseInt(r[3])})}));var c=r[4].split("|");n.inputResources.forEach((function(e,t){var n=c[t].split(Ge);if(3!==n.length)throw new Error("INVALID DATA [inputResources]");e.value=n[0],e.weight=n[1],e.unlimited=!!parseInt(n[2])})),n.allowHandGatheredItems=!!parseInt(r[5]);var s=r[6].split(Ge);if(4!==s.length)throw new Error("INVALID DATA [weightingOptions]");return n.weightingOptions.resources=s[0],n.weightingOptions.power=s[1],n.weightingOptions.complexity=s[2],n.weightingOptions.buildings=s[3],n}(e,t);throw new Error("INVALID VERSION")}(t.encoding,t.gameData)}catch(O){return console.error(O),Ze(t.gameData)}case"LOAD_FROM_SESSION_STORAGE":try{return t.sessionState}catch(O){return console.error(O),Ze(t.gameData)}default:return e}}var Je=Object(r.createContext)(null);function $e(){var e=Object(r.useContext)(Je);if(!e)throw new Error("ProductionContext is null");return e}Je.displayName="ProductionContext";var Qe=se.a.debounce((function(e,t){t(e)}),300,{leading:!1,trailing:!0}),Xe=se.a.debounce(function(){var e=Object(E.a)(C.a.mark((function e(t,n,r,i){var a,o;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Qe(!0,i),e.prev=1,a=new Re(t,n),e.next=5,a.exec();case 5:o=e.sent,r((function(e){return!e||e.timestamp<o.timestamp?(console.log("Computed in: ".concat(o.computeTime,"ms")),o):e})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),r({productionGraph:null,report:null,timestamp:performance.now(),computeTime:0,error:e.t0});case 12:return e.prev=12,Qe(!1,i),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])})));return function(t,n,r,i){return e.apply(this,arguments)}}(),300,{leading:!0,trailing:!0}),et=function(e){var t,n=e.gameData,i=e.gameVersion,a=e.initializer,o=e.triggerInitialize,c=e.children,s=Object(r.useReducer)(Ye,Ze(n)),l=Object(T.a)(s,2),u=l[0],d=l[1],p=U(u),b=Object(r.useState)(null),h=Object(T.a)(b,2),m=h[0],g=h[1],f=Object(r.useState)(!1),j=Object(T.a)(f,2),x=j[0],y=j[1],v=pe({key:"auto-calculate",defaultValue:"true"}),I=Object(T.a)(v,2),k=I[0],_=I[1],S="true"===k,D=re(),N=z(function(){var e=Object(E.a)(C.a.mark((function e(t){var n,r,i;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={factoryConfig:{gameVersion:t.gameVersion,productionItems:t.factoryConfig.productionItems.map((function(e){return{itemKey:e.itemKey,mode:e.mode,value:Number(e.value)}})),inputItems:t.factoryConfig.inputItems.map((function(e){return{itemKey:e.itemKey,value:Number(e.value),weight:Number(e.weight),unlimited:e.unlimited}})),inputResources:t.factoryConfig.inputResources.map((function(e){return{itemKey:e.itemKey,value:Number(e.value),weight:Number(e.weight),unlimited:e.unlimited}})),allowHandGatheredItems:t.factoryConfig.allowHandGatheredItems,weightingOptions:{resources:Number(t.factoryConfig.weightingOptions.resources),power:Number(t.factoryConfig.weightingOptions.power),complexity:Number(t.factoryConfig.weightingOptions.complexity),buildings:Number(t.factoryConfig.weightingOptions.buildings)},allowedRecipes:Object.keys(t.factoryConfig.allowedRecipes).filter((function(e){return t.factoryConfig.allowedRecipes[e]}))}},e.next=3,M("/share-factory",n);case 3:return r=e.sent,i=r.data,e.abrupt("return",i.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),R=Object(r.useCallback)((function(){D.refreshTip(),Xe(u,n,g,y)}),[D,n,u]),A=function(e){_(e?"true":"false"),e&&R()},P=function(){N.request({factoryConfig:u,gameVersion:i})},L=Object(r.useMemo)((function(){var e,t,n="",r=(null===(e=N.data)||void 0===e?void 0:e.key)||(null===a||void 0===a?void 0:a.shareKey);return r&&(n="".concat(window.location.protocol,"//").concat(window.location.host).concat(window.location.pathname,"?").concat(w,"=").concat(r)),{link:n,copyToClipboard:!!(null===(t=N.data)||void 0===t?void 0:t.key),loading:N.loading}}),[null===a||void 0===a?void 0:a.shareKey,null===(t=N.data)||void 0===t?void 0:t.key,N.loading]);Object(r.useEffect)((function(){o&&((null===a||void 0===a?void 0:a.factoryConfig)?d({type:"LOAD_FROM_SHARED_FACTORY",config:a.factoryConfig,gameData:n}):(null===a||void 0===a?void 0:a.legacyEncoding)?d({type:"LOAD_FROM_LEGACY_ENCODING",encoding:a.legacyEncoding,gameData:n}):(null===a||void 0===a?void 0:a.sessionState)?d({type:"LOAD_FROM_SESSION_STORAGE",sessionState:null===a||void 0===a?void 0:a.sessionState,gameData:n}):d({type:"RESET_FACTORY",gameData:n}),R())}),[o]),Object(r.useEffect)((function(){S&&p!==u&&R()}),[S,R,p,u]),Object(r.useEffect)((function(){try{window.sessionStorage.setItem("game-version",i),window.sessionStorage.setItem("state",JSON.stringify(u))}catch(e){console.error(e)}}),[u]);var G=Object(r.useMemo)((function(){return{state:u,dispatch:d,gameData:n,calculating:x,solverResults:m,calculate:R,autoCalculate:S,setAutoCalculate:A,generateShareLink:P,shareLink:L}}),[u,n,x,m,R,S,L]);return Object(O.jsx)(Je.Provider,{value:G,children:c})},tt=n(132),nt=Object(c.c)(tt.a).withConfig({displayName:"Card",componentId:"sc-v08nlw-0"})(["margin-bottom:20px;border-left:5px solid ",";"],(function(e){return e.theme.colors.primary[6]})),rt=n(226),it=n(203),at=n(204),ot=Object(r.createContext)(null);ot.displayName="DrawerContext";var ct=function(e){var t=e.children,n=Object(r.useState)(null),i=Object(T.a)(n,2),a=i[0],o=i[1],c=Object(s.d)();return Object(O.jsxs)(ot.Provider,{value:{rootNode:a},children:[Object(O.jsx)(st,{ref:function(e){o((function(t){return t!==e?e:t}))},topOffset:c.other.headerHeight}),t]})},st=c.c.div.withConfig({displayName:"drawer__DrawerRoot",componentId:"sc-1avkrd7-0"})(["position:fixed;top:",";left:0px;bottom:0px;right:0px;z-index:",";margin:0;padding:0;pointer-events:none;"],(function(e){return e.topOffset}),(function(e){return e.theme.other.drawerZIndex})),lt=Object(r.forwardRef)((function(e,t){var n=e.children,i=e.rootNode,o=e.createRoot,c=e.key,s=e.style,l=Object(r.useRef)(document.createElement("div"));return o||(l.current=i||null),Object(r.useEffect)((function(){return o&&l.current&&(s&&Object.entries(s).forEach((function(e){var t=Object(T.a)(e,2),n=t[0],r=t[1];l.current.style[n]=r})),document.body.append(l.current)),function(){o&&l.current&&l.current.remove()}}),[]),Object(r.useLayoutEffect)((function(){t&&("function"===typeof t?t(l.current):t.current=l.current)}),[t,l]),l.current?Object(a.createPortal)(n,l.current,c):null})),ut=function(e){var t=e.open,n=e.onToggle,i=e.children,a=Object(r.useState)(!t),o=Object(T.a)(a,2),c=o[0],s=o[1],l=Object(X.a)({key:"tooltip-dismissed",defaultValue:"false"}),u=Object(T.a)(l,2),d=u[0],p=u[1],b=function(){var e=Object(r.useContext)(ot);if(!e)throw new Error("DrawerContext is null");return e}(),h="false"===d;return Object(r.useEffect)((function(){t&&p("true")}),[t,p]),Object(r.useEffect)((function(){t&&s(!1)}),[t]),Object(O.jsxs)(lt,{rootNode:b.rootNode,children:[Object(O.jsx)(dt,{open:!!t||h,onClick:function(){t&&(null===n||void 0===n||n(!t))}}),Object(O.jsxs)(pt,{open:!!t,onTransitionEnd:function(){t||s(!0)},children:[Object(O.jsxs)(bt,{onClick:function(){null===n||void 0===n||n(!t)},children:[Object(O.jsxs)(ht,{children:[Object(O.jsxs)(mt,{children:[t?"Close":"Open"," Control Panel"]}),Object(O.jsx)(gt,{children:t?Object(O.jsx)(it.a,{}):Object(O.jsx)(at.a,{})})]}),h&&Object(O.jsxs)(ft,{children:[Object(O.jsx)(jt,{children:"Click here to get started!"}),Object(O.jsx)(Ot,{children:Object(O.jsx)(xt,{onClick:function(e){p("true"),e.stopPropagation()},children:"Dismiss"})})]})]}),Object(O.jsx)(yt,{className:"custom-scrollbar","aria-hidden":!t,$fullyClosed:c,fluid:!0,children:i})]})]})},dt=c.c.div.withConfig({displayName:"Drawer__DrawerDimmer",componentId:"sc-1xpy8vn-0"})(["position:absolute;top:0px;left:0px;bottom:0px;right:0px;margin:0;padding:0;background:#000;opacity:",";transition:opacity 550ms;pointer-events:",";"],(function(e){return e.open?.7:0}),(function(e){return e.open?"auto":"none"})),pt=c.c.div.withConfig({displayName:"Drawer__DrawerContainer",componentId:"sc-1xpy8vn-1"})(["position:relative;top:0px;left:",";width:",";height:100%;background:",";transition:left 550ms;transition-timing-function:cubic-bezier(.68,-0.21,.38,1.26);pointer-events:auto;"],(function(e){var t=e.open,n=e.theme;return t?"0px":"-".concat(n.other.drawerWidth)}),(function(e){return e.theme.other.drawerWidth}),(function(e){return e.theme.colors.background[0]})),bt=c.c.div.withConfig({displayName:"Drawer__DrawerToggle",componentId:"sc-1xpy8vn-2"})(["position:absolute;display:flex;align-items:center;justify-content:center;top:0px;bottom:0px;right:-25px;width:25px;background:",";cursor:pointer;&:hover{background:",";}"],(function(e){return e.theme.colors.primary[6]}),(function(e){return e.theme.colors.primary[7]})),ht=Object(c.c)(rt.a).withConfig({displayName:"Drawer__ToggleLabel",componentId:"sc-1xpy8vn-3"})(["position:relative;display:flex;align-items:center;justify-content:center;flex:0 0 auto;right:-25px;width:30px;height:160px;border-radius:2px;font-size:18px;font-weight:bold;background:",";color:",";overflow:visible;white-space:nowrap;",":hover &{background:",";}::before{content:'';position:absolute;top:-24px;right:2px;width:50px;height:26px;background:",";transform:rotate(50deg);z-index:1;",":hover &{background:",";}}::after{content:'';position:absolute;bottom:-24px;right:2px;width:50px;height:26px;background:",";transform:rotate(-50deg);z-index:1;",":hover &{background:",";}}"],(function(e){return e.theme.colors.primary[6]}),(function(e){return e.theme.white}),bt,(function(e){return e.theme.colors.primary[7]}),(function(e){return e.theme.colors.primary[6]}),bt,(function(e){return e.theme.colors.primary[7]}),(function(e){return e.theme.colors.primary[6]}),bt,(function(e){return e.theme.colors.primary[7]})),mt=c.c.span.withConfig({displayName:"Drawer__ToggleLabelText",componentId:"sc-1xpy8vn-4"})(["position:absolute;left:-16px;z-index:2;writing-mode:vertical-rl;text-orientation:mixed;"]),gt=c.c.span.withConfig({displayName:"Drawer__ToggleLabelIcon",componentId:"sc-1xpy8vn-5"})(["position:absolute;left:5px;z-index:2;"]),ft=Object(c.c)(tt.a).withConfig({displayName:"Drawer__Tooltip",componentId:"sc-1xpy8vn-6"})(["@keyframes lookAtMe{from{left:84px;}to{left:80px;}}animation:300ms infinite alternate lookAtMe;position:absolute;left:80px;padding:20px;z-index:3;background:",";border-radius:2px;pointer-events:none;::before{content:'';position:absolute;top:calc(50% - 10px);left:-10px;width:20px;height:20px;background:",";transform:rotate(45deg);z-index:-1;}"],(function(e){return e.theme.colors.info[6]}),(function(e){return e.theme.colors.info[6]})),jt=Object(c.c)(Y.a).withConfig({displayName:"Drawer__TooltipText",componentId:"sc-1xpy8vn-7"})(["width:180px;height:40px;"]),Ot=c.c.div.withConfig({displayName:"Drawer__TooltipConfirmContainer",componentId:"sc-1xpy8vn-8"})(["display:flex;width:100%;justify-content:flex-end;"]),xt=Object(c.c)(rt.a).withConfig({displayName:"Drawer__TooltipConfirm",componentId:"sc-1xpy8vn-9"})(["pointer-events:auto;color:",";text-decoration:underline;"],(function(e){return e.theme.white})),yt=Object(c.c)(d.a).withConfig({displayName:"Drawer__DrawerContent",componentId:"sc-1xpy8vn-10"})(["visibility:",";position:absolute;top:0px;bottom:0px;left:0px;right:0px;padding:10px;padding-bottom:30px;overflow:auto;overscroll-behavior:contain;"],(function(e){return e.$fullyClosed?"hidden":"visible"})),vt=n(227),wt=n(230),It=n(218),Tt=n(206),kt=n(209),Ct=n(220),Et=n(210),_t=n(211),St=n(212),Dt=Object(c.c)(nt).withConfig({displayName:"Section",componentId:"sc-1q90yqy-0"})(["background:",";box-shadow:0px 0px 24px -6px #0F1011;border:3px solid ",";padding:20px;"],(function(e){return e.theme.colors.background[1]}),(function(e){return e.theme.colors.background[3]})),Nt=Object(c.c)(Y.a).withConfig({displayName:"Section__SectionDescription",componentId:"sc-1q90yqy-1"})(["margin-bottom:20px;"]),Rt=n(205),At=function(e){return Object(O.jsx)(vt.a,Object(_.a)(Object(_.a)({},e),{},{color:"danger",style:Object(_.a)(Object(_.a)({},(null===e||void 0===e?void 0:e.style)||{}),{},{width:"36px",height:"36px",padding:"0px",flex:"0 0 auto"}),children:Object(O.jsx)(Rt.a,{size:20})}))},Pt=[{value:"per-minute",label:"Items Per Min"},{value:"maximize",label:"Maximize Output"}],Mt=Array(20).fill("").map((function(e,t){return{value:"".concat(t+1),label:"Priority: ".concat(t+1)}})).reverse(),Lt=function(){var e=$e(),t=Object(r.useMemo)((function(){var t=Object.keys(e.gameData.items).filter((function(t){return 0!==e.gameData.items[t].producedFromRecipes.length&&!e.gameData.resources[t]})).map((function(t){return{value:t,label:e.gameData.items[t].name}})).sort((function(e,t){return e.label>t.label?1:-1}));return t.unshift({value:Ne,label:"AWESOME Sink Points (x1000)"}),t}),[e.gameData]);return Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)(Dt,{children:[Object(O.jsx)(b.a,{order:3,children:"Production Goals"}),Object(O.jsx)(Nt,{children:"Select the items you want to produce. When maximizing multiple outputs, higher priority items will be maximized first. When selecting a recipe as a target, the factory will be forced to use that recipe for the final output."}),e.state.productionItems.map((function(n){var r=[].concat(Pt);if(n.itemKey){var i=e.gameData.items[n.itemKey];((null===i||void 0===i?void 0:i.producedFromRecipes)||[]).forEach((function(t){var a=e.gameData.recipes[t],o=null===a||void 0===a?void 0:a.products.find((function(e){return e.itemClass===n.itemKey}));if(o){var c=i.name===a.name?"Base Recipe":a.name.replace("Alternate: ","");r.push({value:t,label:"".concat(c," [").concat(o.perMinute,"/min]")})}}))}var a=t.find((function(e){return e.value===n.itemKey}));return Object(O.jsxs)(zt,{children:[Object(O.jsxs)(Ut,{children:[Object(O.jsx)(p.a,{placeholder:"Select an item",label:"Item",clearable:!0,searchable:!0,filter:function(e,t){var n;return!(!a||e!==a.label)||!!(null===(n=t.label)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase()))},data:t,value:n.itemKey?n.itemKey:"",onChange:function(t){e.dispatch({type:"SET_PRODUCTION_ITEM",data:{key:n.key,itemKey:t}})},style:{flex:"1 1 auto"}}),Object(O.jsx)(At,{onClick:function(){e.dispatch({type:"DELETE_PRODUCTION_ITEM",key:n.key})},style:{position:"relative",top:"13px"}})]}),Object(O.jsxs)(Ut,{children:["maximize"===n.mode?Object(O.jsx)(p.a,{label:"Priority",data:Mt,value:n.value,onChange:function(t){e.dispatch({type:"SET_PRODUCTION_ITEM_AMOUNT",data:{key:n.key,amount:t}})},style:{width:"160px"}}):Object(O.jsx)(Tt.a,{label:"Amount",className:"no-spinner",type:"number",min:"0",step:"1",value:n.value,onChange:function(t){e.dispatch({type:"SET_PRODUCTION_ITEM_AMOUNT",data:{key:n.key,amount:t.currentTarget.value}})},style:{width:"160px"}}),Object(O.jsx)(p.a,{label:"Mode",data:r,value:n.mode,onChange:function(t){e.dispatch({type:"SET_PRODUCTION_ITEM_MODE",data:{key:n.key,mode:t}})},style:{width:"280px"}})]}),Object(O.jsx)(J.a,{style:{marginTop:"10px",marginBottom:"10px"}})]},n.key)})),Object(O.jsx)(vt.a,{onClick:function(){e.dispatch({type:"ADD_PRODUCTION_ITEM"})},children:"+ Add Product"})]})})},Ut=Object(c.c)(h.a).withConfig({displayName:"ProductionTab__Row",componentId:"sc-nm3itj-0"})(["margin-bottom:5px;"]),zt=c.c.div.withConfig({displayName:"ProductionTab__ItemContainer",componentId:"sc-nm3itj-1"})(["margin-bottom:20px;"]),Gt=n(222),Ft=n(207),Kt=n(228),Wt=function(e){var t=e.label,n=e.tooltip;return Object(O.jsxs)(Vt,{children:[t," ",Object(O.jsx)(Kt.a,{label:n,withArrow:!0,color:"dark",width:230,wrapLines:!0,arrowSize:8,children:Object(O.jsx)(Ft.a,{size:12})})]})},Vt=c.c.div.withConfig({displayName:"LabelWithTooltip__Label",componentId:"sc-15u25t5-0"})(["position:relative;cursor:pointer;"]),Bt=function(){var e=$e(),t=Object(r.useMemo)((function(){return Object.keys(e.gameData.items).filter((function(t){return 0!==e.gameData.items[t].producedFromRecipes.length&&0!==e.gameData.items[t].usedInRecipes.length&&!e.gameData.resources[t]})).map((function(t){return{value:t,label:e.gameData.items[t].name}})).sort((function(e,t){return e.label>t.label?1:-1}))}),[e.gameData]);return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)(Dt,{children:[Object(O.jsx)(b.a,{order:3,children:"Input Items"}),Object(O.jsx)(Nt,{children:"Select the items that you already have available and don't need to produce in this factory."}),e.state.inputItems.map((function(n){var r=t.find((function(e){return e.value===n.itemKey}));return Object(O.jsxs)(qt,{children:[Object(O.jsxs)(Ht,{children:[Object(O.jsx)(p.a,{placeholder:"Select an item",label:"Item",clearable:!0,searchable:!0,filter:function(e,t){var n;return!(!r||e!==r.label)||!!(null===(n=t.label)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase()))},data:t,value:n.itemKey?n.itemKey:"",onChange:function(t){e.dispatch({type:"UPDATE_INPUT_ITEM",data:Object(_.a)(Object(_.a)({},n),{},{itemKey:t})})},style:{flex:"1 1 auto"}}),Object(O.jsx)(At,{onClick:function(){e.dispatch({type:"DELETE_INPUT_ITEM",key:n.key})},style:{position:"relative",top:"13px"}})]}),Object(O.jsxs)(Ht,{children:[Object(O.jsx)(Tt.a,{label:"Amount",className:"no-spinner",type:"number",min:"0",step:"1",disabled:n.unlimited,value:n.value,onChange:function(t){e.dispatch({type:"UPDATE_INPUT_ITEM",data:Object(_.a)(Object(_.a)({},n),{},{value:t.currentTarget.value})})}}),Object(O.jsx)(Gt.a,{className:"label",label:"Unlimited",checked:n.unlimited,onChange:function(){e.dispatch({type:"UPDATE_INPUT_ITEM",data:Object(_.a)(Object(_.a)({},n),{},{unlimited:!n.unlimited})})},style:{position:"relative",top:"13px"}})]}),Object(O.jsx)(J.a,{style:{marginTop:"10px",marginBottom:"10px"}})]},n.key)})),Object(O.jsx)(vt.a,{onClick:function(){e.dispatch({type:"ADD_INPUT_ITEM"})},children:"+ Add Input"})]}),Object(O.jsxs)(Dt,{children:[Object(O.jsx)(b.a,{order:3,children:"Weighting Options"}),Object(O.jsx)(Nt,{children:"Adjust the weights affecting the importance of various properties of the factory. A value of 0 indicates that that property is not considered during factory layout."}),function(){var t=e.state.weightingOptions;return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)(h.a,{grow:!0,children:[Object(O.jsx)(Tt.a,{label:Object(O.jsx)(Wt,{label:"Resource Efficiency",tooltip:"This weighting prioritizes using as few resources as possible."}),className:"no-spinner",type:"number",min:"0",step:"1",value:t.resources,onChange:function(n){e.dispatch({type:"UPDATE_WEIGHTING_OPTIONS",data:Object(_.a)(Object(_.a)({},t),{},{resources:n.currentTarget.value})})}}),Object(O.jsx)(Tt.a,{label:Object(O.jsx)(Wt,{label:"Power Efficiency",tooltip:"This weighting prioritizes using as little power as possible."}),className:"no-spinner",type:"number",min:"0",step:"1",value:t.power,onChange:function(n){e.dispatch({type:"UPDATE_WEIGHTING_OPTIONS",data:Object(_.a)(Object(_.a)({},t),{},{power:n.currentTarget.value})})}})]}),Object(O.jsxs)(h.a,{grow:!0,style:{marginTop:"10px"},children:[Object(O.jsx)(Tt.a,{label:Object(O.jsx)(Wt,{label:"Complexity",tooltip:"This weighting prioritizes reducing the number of item types used in the factory. Very slow to optimize for larger factories (WIP)."}),className:"no-spinner",type:"number",min:"0",step:"1",value:t.complexity,onChange:function(n){e.dispatch({type:"UPDATE_WEIGHTING_OPTIONS",data:Object(_.a)(Object(_.a)({},t),{},{complexity:n.currentTarget.value})})}}),Object(O.jsx)(Tt.a,{label:Object(O.jsx)(Wt,{label:"Buildings",tooltip:"This weighting prioritizes using as few buildings as possible, discounting overclocking. May not be perfectly optimal, especially for smaller factories (WIP)."}),type:"number",min:"0",step:"1",value:t.buildings,onChange:function(n){e.dispatch({type:"UPDATE_WEIGHTING_OPTIONS",data:Object(_.a)(Object(_.a)({},t),{},{buildings:n.currentTarget.value})})}})]})]})}(),Object(O.jsx)(vt.a,{color:"danger",onClick:function(){e.dispatch({type:"SET_ALL_WEIGHTS_DEFAULT",gameData:e.gameData})},style:{marginTop:"15px"},children:"Reset All Weights"})]}),Object(O.jsxs)(Dt,{children:[Object(O.jsx)(b.a,{order:3,children:"Raw Resources"}),Object(O.jsx)(Nt,{children:"Select the raw resources that are available to your factory. The default values are set to the map limits. The weight value is a number representing how valuable that resource is when comparing recipes. The defaults are calculated automatically according to node rarity."}),Object(O.jsxs)(h.a,{style:{marginBottom:"15px"},children:[Object(O.jsx)(vt.a,{color:"danger",onClick:function(){e.dispatch({type:"SET_RESOURCES_TO_MAP_LIMITS",gameData:e.gameData})},children:"Set All To Maximum"}),Object(O.jsx)(vt.a,{color:"danger",onClick:function(){e.dispatch({type:"SET_RESOURCES_TO_0"})},children:"Set All To 0"})]}),Object(O.jsx)(Gt.a,{label:"Allow hand-gathered resources (mycelia, flower petals, etc)",checked:e.state.allowHandGatheredItems,onChange:function(t){e.dispatch({type:"SET_ALLOW_HAND_GATHERED_ITEMS",active:t.currentTarget.checked})},style:{marginBottom:"25px"}}),e.state.inputResources.map((function(t){return Object(O.jsxs)(qt,{children:[Object(O.jsx)(Ht,{children:Object(O.jsx)(Y.a,{style:{fontWeight:"bold"},children:e.gameData.items[t.itemKey].name})}),Object(O.jsxs)(Ht,{children:[Object(O.jsx)(Tt.a,{label:"Amount",className:"no-spinner",type:"number",min:"0",step:"1",value:t.value,onChange:function(n){e.dispatch({type:"UPDATE_INPUT_RESOURCE",data:Object(_.a)(Object(_.a)({},t),{},{value:n.currentTarget.value})})},disabled:t.unlimited,style:{flex:"1 1 auto"}}),Object(O.jsx)(Gt.a,{label:"Unlimited",checked:t.unlimited,onChange:function(n){e.dispatch({type:"UPDATE_INPUT_RESOURCE",data:Object(_.a)(Object(_.a)({},t),{},{unlimited:n.currentTarget.checked})})},style:{position:"relative",top:"13px",flex:"1 1 auto"}}),Object(O.jsx)(Tt.a,{label:"Weight",className:"no-spinner",type:"number",min:"0",step:"1",value:t.weight,onChange:function(n){e.dispatch({type:"UPDATE_INPUT_RESOURCE",data:Object(_.a)(Object(_.a)({},t),{},{weight:n.currentTarget.value})})},style:{flex:"0 0 100px"}})]}),Object(O.jsx)(J.a,{style:{marginTop:"10px",marginBottom:"10px"}})]},t.key)}))]})]})},Ht=Object(c.c)(h.a).withConfig({displayName:"InputsTab__Row",componentId:"sc-l6znri-0"})(["margin-bottom:5px;"]),qt=c.c.div.withConfig({displayName:"InputsTab__ItemContainer",componentId:"sc-l6znri-1"})(["margin-bottom:20px;"]),Zt=n(219),Yt=n(229),Jt=n(133),$t=n(208),Qt=/^Alternate: /,Xt=function(){var e=$e(),t=Object(r.useState)(""),n=Object(T.a)(t,2),i=n[0],a=n[1],o=Object(r.useMemo)((function(){var t=[],n=[];return Object.entries(e.gameData.recipes).forEach((function(e){var r=Object(T.a)(e,2),i=r[0],a=r[1];a.isAlternate?n.push({key:i,label:a.name.replace(Qt,"")}):t.push({key:i,label:a.name})})),t.sort((function(e,t){return e.label>t.label?1:-1})),n.sort((function(e,t){return e.label>t.label?1:-1})),{baseRecipes:t,altRecipes:n}}),[e.gameData]),c=o.baseRecipes,s=o.altRecipes,l=Object(r.useCallback)((function(t){return t.map((function(t){var n=t.key,r=t.label;return{key:n,label:r,component:Object(O.jsx)(Zt.a.Item,{children:Object(O.jsx)(Gt.a,{label:r,checked:e.state.allowedRecipes[n],onChange:function(){e.dispatch({type:"SET_RECIPE_ACTIVE",key:n,active:!e.state.allowedRecipes[n]})}})},n)}}))}),[e.state,e.dispatch]),u=Object(r.useMemo)((function(){return l(c)}),[l]),d=Object(r.useMemo)((function(){return l(s)}),[l]);function p(t){var n=(t?d:u).filter((function(e){return e.label.toLowerCase().includes(i.toLowerCase())})),r=n.map((function(e){return e.key}));return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)(h.a,{style:{marginTop:"5px",marginBottom:"10px"},children:[Object(O.jsx)(vt.a,{onClick:function(){e.dispatch({type:"MASS_SET_RECIPES_ACTIVE",recipes:r,active:!0})},children:"Select All"}),Object(O.jsx)(vt.a,{onClick:function(){e.dispatch({type:"MASS_SET_RECIPES_ACTIVE",recipes:r,active:!1})},children:"Select None"})]}),Object(O.jsx)(Zt.a,{listStyleType:"none",spacing:6,children:n.map((function(e){return e.component}))})]})}return Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)(Dt,{children:[Object(O.jsx)(b.a,{order:3,children:"Recipes"}),Object(O.jsx)(Nt,{children:"Select the recipes that you want to be considered in this factory."}),Object(O.jsx)(Tt.a,{placeholder:"Search...","aria-label":"search recipes",icon:Object(O.jsx)($t.a,{size:16}),value:i,onChange:function(e){a(e.currentTarget.value)},style:{marginBottom:"10px"}}),Object(O.jsxs)(Yt.a,{grow:!0,style:{position:"relative"},children:[Object(O.jsxs)(Jt.a,{span:6,children:[Object(O.jsx)(b.a,{order:3,children:"Alternate Recipes"}),p(!0)]}),Object(O.jsxs)(Jt.a,{span:6,children:[Object(O.jsx)(b.a,{order:3,children:"Base Recipes"}),p(!1)]}),Object(O.jsx)(en,{})]})]})})},en=c.c.div.withConfig({displayName:"RecipesTab__VDivider",componentId:"sc-1s1jhip-0"})(["position:absolute;top:20px;bottom:20px;left:255px;width:1px;background:",";"],(function(e){return e.theme.colors.background[3]})),tn=function(){var e=$e(),t=Object(r.useState)(!1),n=Object(T.a)(t,2),i=n[0],a=n[1],o=U(e.shareLink.link);Object(r.useEffect)((function(){e.shareLink.copyToClipboard&&e.shareLink.link&&e.shareLink.link!==o&&(navigator.clipboard.writeText(e.shareLink.link),a(!0))}),[e.shareLink,o]);return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)(tt.a,{style:{marginBottom:"20px",paddingTop:"10px"},children:[Object(O.jsx)(b.a,{order:2,children:"Control Panel"}),Object(O.jsx)(J.a,{style:{marginTop:"5px",marginBottom:"15px"}}),Object(O.jsxs)(h.a,{style:{marginBottom:"15px"},children:[Object(O.jsx)(vt.a,{onClick:function(){e.calculate()},disabled:e.autoCalculate,style:{marginRight:"15px",width:"125px"},children:"Calculate"}),Object(O.jsx)(wt.a,{size:"md",label:"Auto-calculate (disable if things get laggy)",checked:e.autoCalculate,onChange:function(t){e.setAutoCalculate(t.currentTarget.checked)}})]}),Object(O.jsxs)(h.a,{style:{marginBottom:"15px"},children:[Object(O.jsx)(vt.a,{color:"positive",onClick:function(){e.generateShareLink()},loading:e.shareLink.loading,style:{width:"125px"},children:"Save & Share"}),Object(O.jsx)(It.a,{opened:i,onClose:function(){return a(!1)},position:"right",withArrow:!0,styles:{root:{flex:"1 1 auto !important"},inner:{padding:"10px 16px"}},target:Object(O.jsx)(Tt.a,{value:e.shareLink.link,placeholder:"Save factory to generate a link",readOnly:!0,onClick:function(){e.shareLink&&(navigator.clipboard.writeText(e.shareLink.link),a(!0))},styles:{root:{flex:"1 1 auto !important"}}}),children:Object(O.jsx)(Y.a,{children:"Link copied!"})})]}),Object(O.jsx)(kt.a,{}),Object(O.jsx)(h.a,{style:{marginBottom:"15px"},position:"right",children:Object(O.jsx)(vt.a,{color:"danger",onClick:function(){e.dispatch({type:"RESET_FACTORY",gameData:e.gameData})},children:"Reset ALL Factory Options"})})]}),Object(O.jsxs)(Ct.a,{grow:!0,variant:"outline",children:[Object(O.jsx)(Ct.a.Tab,{label:"Production",icon:Object(O.jsx)(Et.a,{size:18}),children:Object(O.jsx)(nn,{fluid:!0,children:Object(O.jsx)(Lt,{})})}),Object(O.jsx)(Ct.a.Tab,{label:"Inputs",icon:Object(O.jsx)(_t.a,{size:18}),children:Object(O.jsx)(nn,{fluid:!0,children:Object(O.jsx)(Bt,{})})}),Object(O.jsx)(Ct.a.Tab,{label:"Recipes",icon:Object(O.jsx)(St.a,{size:18}),children:Object(O.jsx)(nn,{fluid:!0,children:Object(O.jsx)(Xt,{})})})]})]})},nn=Object(c.c)(d.a).withConfig({displayName:"PlannerOptions__TabContainer",componentId:"sc-tzv5w1-0"})(["padding:15px 15px;background:",""],(function(e){return e.theme.colors.background[1]})),rn=n(215),an=n(216),on=n(7),cn=n(66),sn=n.n(cn),ln=n(126),un=n.n(ln),dn=n(127),pn=n.n(dn),bn=n(128),hn=n.n(bn),mn=n(213),gn=n(214),fn="-apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif",jn="77%",On="63%",xn="58%",yn="58%",vn={resource:{base:"hsl(31, ".concat(jn,", ").concat(On,")"),selected:"hsl(31, ".concat(xn,", ").concat(yn,")")},input:{base:"hsl(0, ".concat(jn,", ").concat(On,")"),selected:"hsl(0, ".concat(xn,", ").concat(yn,")")},handGathered:{base:"hsl(261, ".concat(jn,", ").concat(On,")"),selected:"hsl(261, ".concat(xn,", ").concat(yn,")")},sideProduct:{base:"hsl(311, ".concat(jn,", ").concat(On,")"),selected:"hsl(311, ".concat(xn,", ").concat(yn,")")},finalProduct:{base:"hsl(128, ".concat(jn,", ").concat(On,")"),selected:"hsl(128, ".concat(xn,", ").concat(yn,")")},recipe:{base:"hsl(197, ".concat(jn,", ").concat(On,")"),selected:"hsl(197, ".concat(xn,", ").concat(yn,")")},nuclear:{base:"hsl(50, ".concat(jn,", ").concat(On,")"),selected:"hsl(50, ".concat(xn,", ").concat(yn,")")},edge:{line:"#999999",label:"#eeeeee"},incoming:{line:"hsl(31, ".concat(jn,", ").concat(On,")"),label:"hsl(31, ".concat(jn,", ").concat(On,")")},outgoing:{line:"hsl(128, ".concat(jn,", ").concat(On,")"),label:"hsl(128, ".concat(jn,", ").concat(On,")")}},wn={primaryColor:"primary",colors:{primary:["#fcebde","#f9d8be","#f7c59f","#f4b17f","#f19e60","#ef8b40","#ec7821","#c4631c","#94501e","#673c1c"],positive:["#e9f3ea","#d5e8d6","#c1ddc2","#acd2ae","#98c69a","#83bb86","#6fb072","#58965c","#49744b","#39543a"],danger:["#fdb5b5","#fda3a3","#fc9191","#fc7e7e","#fb6c6c","#fa5959","#fa4747","#f12929","#dc1818","#b21b1b"],background:["#26282b","#373b40","#3f434a","#50565e","#6c7582","#ffffff","#ffffff","#ffffff","#b3b6ba","#ffffff"],info:Array(10).fill("#3065c7")},white:"#eee",fontFamily:fn,radius:{xs:0,sm:2,md:4,lg:8,xl:16},headings:{fontFamily:fn,fontWeight:700,sizes:{h1:{fontSize:36,lineHeight:1.3},h2:{fontSize:30,lineHeight:1.35},h3:{fontSize:22,lineHeight:1.4},h4:{fontSize:18,lineHeight:1.45},h5:{fontSize:16,lineHeight:1.5},h6:{fontSize:14,lineHeight:1.5}}},other:{headerHeight:"64px",pageLeftMargin:"55px",drawerWidth:"620px",drawerZIndex:"10",tooltipZIndex:"9999",scrollbarTrackColor:"#212226",scrollbarThumbColor:"#6c6c73"}},In={AppShell:function(e){return{root:{minHeight:"100vh"}}},Paper:function(e){return{root:{background:e.colors.background[1],padding:"15px"}}},Text:function(e){return{root:{color:e.white}}},Title:function(e){return{root:{color:e.white}}},List:function(e){return{item:{color:e.white}}},Anchor:function(e){return{root:{color:e.colors.primary[6]}}},Select:function(e){return{label:{color:e.white},item:{borderRadius:"0px"},hovered:{background:e.colors.background[8]},selected:{color:e.white,background:e.colors.primary[5]}}},TextInput:function(e){return{label:{color:e.white}}},Checkbox:function(e){return{label:{cursor:"pointer",color:e.white},input:{cursor:"pointer"}}},Switch:function(e){return{label:{cursor:"pointer",color:e.white},input:{cursor:"pointer",background:e.colors.background[1],borderWidth:"2px","&:checked":{background:e.colors.primary[6],borderColor:e.colors.primary[6]}}}},Divider:function(e){return{horizontal:{borderTopColor:e.colors.background[3]}}},Button:function(e){return{root:{color:"#fff","&[disabled]":{color:"".concat(e.white," !important"),opacity:.5,"&:not(.mantine-Button-loading)":{backgroundColor:"".concat(e.colors.primary[6]," !important")}}}}},Tabs:function(e){return{tabLabel:{color:e.white,fontFamily:"'M PLUS 1 Code', sans-serif",fontSize:"16px"},tabIcon:{color:e.white},tabActive:{background:"".concat(e.colors.background[1]," !important"),borderBottomWidth:"0px !important"},body:{paddingTop:"0px",background:e.colors.background[0],borderBottomLeftRadius:"2px",borderBottomRightRadius:"2px"}}},Tooltip:function(e){return{body:{background:e.colors.background[2],border:"1px solid #aaa"},arrow:{background:e.colors.background[2],borderBottom:"1px solid #aaa",borderRight:"1px solid #aaa"}}},Popover:function(e){return{body:{background:e.colors.background[2],borderColor:"#aaa"},arrow:{background:e.colors.background[2],borderColor:"#aaa"}}}};function Tn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return e.toFixed(t).replace(/\.?0+$/,"")}var kn,Cn=Object(r.forwardRef)((function(e,t){var n=e.currentNode,r=Object(s.d)(),i=$e();return Object(O.jsx)(lt,{ref:t,createRoot:!0,style:{zIndex:r.other.tooltipZIndex,pointerEvents:"none"},children:n?function(){var e=n.data();return e.type===De?function(e){var t=i.gameData.recipes[e.key],n=t.products[0],r=Math.ceil(e.multiplier),a=e.multiplier/r*100,o=n.perMinute*e.multiplier/r;return Object(O.jsxs)(En,{children:[Object(O.jsxs)(_n,{order:3,children:["Recipe: [",t.name,"]"]}),Object(O.jsx)(Dn,{}),Object(O.jsxs)(Sn,{children:[Object(O.jsx)("b",{children:"Buildings:"})," ",r,"x ",i.gameData.buildings[t.producedIn].name]}),Object(O.jsxs)(Sn,{children:[Object(O.jsx)("b",{children:"Clock speed:"})," ",Tn(a),"% each"]}),Object(O.jsxs)(Sn,{children:[Object(O.jsx)("b",{children:"Items per min:"})," ",Tn(o)," each"]}),Object(O.jsx)(Dn,{}),Object(O.jsx)(Sn,{children:Object(O.jsx)("b",{children:"Inputs:"})}),Object(O.jsx)(Zt.a,{listStyleType:"none",withPadding:!0,children:t.ingredients.map((function(t){return Object(O.jsx)(Zt.a.Item,{children:Object(O.jsxs)(Sn,{children:[i.gameData.items[t.itemClass].name,": ",Tn(t.perMinute*e.multiplier)," / min"]})})}))}),Object(O.jsx)(Sn,{children:Object(O.jsx)("b",{children:"Outputs:"})}),Object(O.jsx)(Zt.a,{listStyleType:"none",withPadding:!0,children:t.products.map((function(t){return Object(O.jsx)(Zt.a.Item,{children:Object(O.jsxs)(Sn,{children:[i.gameData.items[t.itemClass].name,": ",Tn(t.perMinute*e.multiplier)," / min"]})})}))})]})}(e):e.type===Se?"Desc_Water_C"===e.key?function(e){var t=i.gameData.items[e.key];return Object(O.jsxs)(En,{children:[Object(O.jsxs)(_n,{order:3,children:["Resource: [",t.name,"]"]}),Object(O.jsx)(Dn,{}),Object(O.jsxs)(Sn,{children:[Object(O.jsx)("b",{children:"Extractors required:"})," ",Tn(e.multiplier/120,2),"x Water Extractor"]})]})}(e):"Desc_LiquidOil_C"===e.key?function(e){var t=i.gameData.items[e.key],n=e.multiplier/120;return Object(O.jsxs)(En,{children:[Object(O.jsxs)(_n,{order:3,children:["Resource: [",t.name,"]"]}),Object(O.jsx)(Dn,{}),Object(O.jsx)(Sn,{children:Object(O.jsx)("b",{children:"Extractors required:"})}),Object(O.jsxs)(Nn,{children:[Object(O.jsx)("thead",{children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{}),Object(O.jsx)("th",{children:"100%"}),Object(O.jsx)("th",{children:"150%"}),Object(O.jsx)("th",{children:"200%"}),Object(O.jsx)("th",{children:"250%"})]})}),Object(O.jsxs)("tbody",{children:[Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"Impure"}),Object(O.jsxs)("td",{children:[Tn(2*n,2),"x"]}),Object(O.jsxs)("td",{children:[Tn(2*n/1.5,2),"x"]}),Object(O.jsxs)("td",{children:[Tn(2*n/2,2),"x"]}),Object(O.jsxs)("td",{children:[Tn(2*n/2.5,2),"x"]})]}),Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"Normal"}),Object(O.jsxs)("td",{children:[Tn(n,2),"x"]}),Object(O.jsxs)("td",{children:[Tn(n/1.5,2),"x"]}),Object(O.jsxs)("td",{children:[Tn(n/2,2),"x"]}),Object(O.jsxs)("td",{children:[Tn(n/2.5,2),"x"]})]}),Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"Pure"}),Object(O.jsxs)("td",{children:[Tn(.5*n,2),"x"]}),Object(O.jsxs)("td",{children:[Tn(.5*n/1.5,2),"x"]}),Object(O.jsxs)("td",{children:[Tn(.5*n/2,2),"x"]}),Object(O.jsxs)("td",{children:[Tn(.5*n/2.5,2),"x"]})]})]})]})]})}(e):"Desc_NitrogenGas_C"===e.key?null:function(e){var t=i.gameData.items[e.key],n=e.multiplier/60;return Object(O.jsxs)(En,{children:[Object(O.jsxs)(_n,{order:3,children:["Resource: [",t.name,"]"]}),Object(O.jsx)(Dn,{}),Object(O.jsx)(Sn,{children:Object(O.jsx)("b",{children:"Miners required (assuming normal nodes):"})}),Object(O.jsxs)(Nn,{children:[Object(O.jsx)("thead",{children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{}),Object(O.jsx)("th",{children:"100%"}),Object(O.jsx)("th",{children:"150%"}),Object(O.jsx)("th",{children:"200%"}),Object(O.jsx)("th",{children:"250%"})]})}),Object(O.jsxs)("tbody",{children:[Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"Mk. 1"}),Object(O.jsxs)("td",{children:[Tn(n,2),"x"]}),Object(O.jsxs)("td",{children:[Tn(n/1.5,2),"x"]}),Object(O.jsxs)("td",{children:[Tn(n/2,2),"x"]}),Object(O.jsxs)("td",{children:[Tn(n/2.5,2),"x"]})]}),Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"Mk. 2"}),Object(O.jsxs)("td",{children:[Tn(.5*n,2),"x"]}),Object(O.jsxs)("td",{children:[Tn(.5*n/1.5,2),"x"]}),Object(O.jsxs)("td",{children:[Tn(.5*n/2,2),"x"]}),Object(O.jsxs)("td",{children:[Tn(.5*n/2.5,2),"x"]})]}),Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"Mk. 3"}),Object(O.jsxs)("td",{children:[Tn(.25*n,2),"x"]}),Object(O.jsxs)("td",{children:[Tn(.25*n/1.5,2),"x"]}),Object(O.jsxs)("td",{children:[Tn(.25*n/2,2),"x"]}),Object(O.jsxs)("td",{children:[Tn(.25*n/2.5,2),"x"]})]})]})]})]})}(e):null}():null})})),En=Object(c.c)(tt.a).withConfig({displayName:"GraphTooltip__Tooltip",componentId:"sc-1osn018-0"})(["position:relative;bottom:50px;background:",";border:1px solid #aaa;min-width:300px;::before{content:'';position:absolute;left:calc(50% - 10px);bottom:-12px;width:20px;height:20px;background:",";border-bottom:1px solid #aaa;border-right:1px solid #aaa;transform:rotate(45deg);z-index:1;}"],(function(e){return e.theme.colors.background[2]}),(function(e){return e.theme.colors.background[2]})),_n=Object(c.c)(b.a).withConfig({displayName:"GraphTooltip__TooltipTitle",componentId:"sc-1osn018-1"})(["font-size:16px;"]),Sn=Object(c.c)(Y.a).withConfig({displayName:"GraphTooltip__TooltipText",componentId:"sc-1osn018-2"})(["font-size:15px;"]),Dn=Object(c.c)(J.a).withConfig({displayName:"GraphTooltip__TooltipDivider",componentId:"sc-1osn018-3"})(["margin-top:10px;margin-bottom:10px;border-top-color:",";"],(function(e){return e.theme.colors.background[4]})),Nn=c.c.table.withConfig({displayName:"GraphTooltip__Table",componentId:"sc-1osn018-4"})(["color:",";border-collapse:collapse;& th,td{padding:10px;text-align:left;font-size:15px;}& td{border:1px solid ",";}& tr:nth-child(2n) td{background:",";}"],(function(e){return e.theme.white}),(function(e){return e.theme.colors.background[4]}),(function(e){return e.theme.colors.background[3]}));sn.a.use(hn.a),sn.a.use(un.a),sn.a.warnings(!1);var Rn={name:"klay",padding:40,klay:{direction:"RIGHT",edgeRouting:"ORTHOGONAL",nodePlacement:"LINEAR_SEGMENTS",edgeSpacingFactor:.2,inLayerSpacingFactor:.7,spacing:90,thoroughness:10}},An=[{selector:"core",style:{"active-bg-color":"#000","active-bg-opacity":0,"active-bg-size":0,"selection-box-color":"#000","selection-box-border-color":"#000","selection-box-border-width":0,"selection-box-opacity":0,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":0}},{selector:"node",style:{label:"data(label)","text-valign":"center","text-halign":"center",height:"30px",width:"150px","text-max-width":"157px","padding-top":"20px","overlay-padding":0,"overlay-opacity":0,"text-wrap":"wrap","font-size":"14px"}},{selector:"edge",style:{label:"data(label)",width:1,"curve-style":"bezier","control-point-step-size":100,"target-arrow-shape":"triangle-backcurve","arrow-scale":1.2,"overlay-padding":0,"overlay-opacity":0,"text-wrap":"wrap","font-size":"14px",color:vn.edge.label,"line-color":vn.edge.line,"target-arrow-color":vn.edge.line}},{selector:"edge.loop",style:{"loop-direction":"180deg","loop-sweep":"-40deg","edge-distances":"node-position","source-endpoint":"-15% 50%","target-endpoint":"15% 50%"}},{selector:"node.item-shape",style:{shape:"ellipse",height:"40px",width:"130px"}},{selector:"node.recipe-shape",style:{shape:"round-rectangle"}},{selector:"node.selected, node.grabbed",style:{"z-index":100,height:"45px",width:"195px","text-max-width":"192px","font-size":"16px","font-weight":"bold","border-width":2}},{selector:"node.item-shape.selected, node.item-shape.grabbed",style:{height:"55px",width:"170px"}},{selector:"node.resource",style:{"background-color":vn.resource.base}},{selector:"node.resource.selected, node.resource.grabbed",style:{"background-color":vn.resource.selected}},{selector:"node.input",style:{"background-color":vn.input.base}},{selector:"node.input.selected, node.input.grabbed",style:{"background-color":vn.input.selected}},{selector:"node.hand-gathered",style:{"background-color":vn.handGathered.base}},{selector:"node.hand-gathered.selected, node.hand-gathered.grabbed",style:{"background-color":vn.handGathered.selected}},{selector:"node.side-product",style:{"background-color":vn.sideProduct.base}},{selector:"node.side-product.selected, node.side-product.grabbed",style:{"background-color":vn.sideProduct.selected}},{selector:"node.final-product",style:{"background-color":vn.finalProduct.base}},{selector:"node.final-product.selected, node.final-product.grabbed",style:{"background-color":vn.finalProduct.selected}},{selector:"node.recipe",style:{"background-color":vn.recipe.base}},{selector:"node.recipe.selected, node.recipe.grabbed",style:{"background-color":vn.recipe.selected}},{selector:"node.nuclear",style:{"background-color":vn.nuclear.base}},{selector:"node.nuclear.selected, node.nuclear.grabbed",style:{"background-color":vn.nuclear.selected}},{selector:"edge.selected, edge.grabbed",style:{width:4,"font-size":"14px","font-weight":"bold","text-outline-width":2,"z-index":100}},{selector:"edge.selected-incoming, edge.grabbed-incoming",style:{color:vn.incoming.label,"line-color":vn.incoming.line,"target-arrow-color":vn.incoming.line}},{selector:"edge.selected-outgoing, edge.grabbed-outgoing",style:{color:vn.outgoing.label,"line-color":vn.outgoing.line,"target-arrow-color":vn.outgoing.line}}],Pn=(kn={},Object(on.a)(kn,ke,"final-product"),Object(on.a)(kn,Ce,"side-product"),Object(on.a)(kn,Ee,"input"),Object(on.a)(kn,_e,"hand-gathered"),Object(on.a)(kn,Se,"resource"),Object(on.a)(kn,De,"recipe"),kn);function Mn(e,t){var n="",r="";if(e.type===De){var i=t.recipes[e.key];n=i.name,r="".concat(Tn(e.multiplier),"x ").concat(t.buildings[i.producedIn].name)}else{var a=t.items[e.key];n=e.type===Ce?"Side Product:\n".concat(a.name):a.name,r="".concat(Tn(e.multiplier)," / min")}return"".concat(n,"\n").concat(r)}function Ln(e,t){var n=[];e.type===De?(n.push("recipe-shape"),"Desc_GeneratorNuclear_C"===t.recipes[e.key].producedIn?n.push("nuclear"):n.push(Pn[e.type])):(n.push("item-shape"),n.push(Pn[e.type]));return n}function Un(e,t){var n=t.items[e.key].name,r="".concat(Tn(e.productionRate)," / min");return"".concat(n,"\n").concat(r)}function zn(e){if(null===e||void 0===e?void 0:e.current){var t=e.current.getBoundingClientRect();e.current.style.height="".concat(window.innerHeight-t.top-40,"px")}}var Gn=function(){var e,t,n=Object(r.useState)(!1),i=Object(T.a)(n,2),a=i[0],o=i[1],c=Object(r.useRef)(null),s=Object(r.useRef)(null),l=Object(r.useRef)(null),u=Object(r.useRef)(null),d=Object(r.useState)(null),p=Object(T.a)(d,2),b=p[0],m=p[1],g=$e(),f=(null===(e=g.solverResults)||void 0===e?void 0:e.productionGraph)||null,j=(null===(t=g.solverResults)||void 0===t?void 0:t.error)||null,x=g.calculating;function y(e){u.current&&(e.getElementById(u.current.nodeId).off("position"),e.off("pan zoom resize"),u.current.popper.destroy(),u.current=null,m(null))}Object(r.useEffect)((function(){function e(){zn(c)}return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]);var v=Object(r.useMemo)((function(){if(null==f)return null;var e=Object(je.a)(),t=[];return Object.entries(f.nodes).forEach((function(e){var n=Object(T.a)(e,2),r=(n[0],n[1]);t.push({group:"nodes",data:Object(_.a)(Object(_.a)({},r),{},{label:Mn(r,g.gameData)}),classes:Ln(r,g.gameData)})})),f.edges.forEach((function(e){t.push({group:"edges",data:Object(_.a)(Object(_.a)({},e),{},{source:e.from,target:e.to,label:Un(e,g.gameData)}),classes:e.from===e.to?["loop"]:void 0})})),{key:e,elements:t}}),[f]);return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)(Fn,{fluid:!0,ref:function(e){e&&!c.current&&(c.current=e,zn(c),o(!0))},children:[x&&Object(O.jsx)(mn.a,{style:{position:"absolute",height:"100%",width:"100%"},children:Object(O.jsx)(Z.a,{size:50})}),a&&!x&&(null!=v?Object(O.jsx)(pn.a,{elements:v.elements,layout:Rn,stylesheet:An,boxSelectionEnabled:!1,wheelSensitivity:.13,maxZoom:3,minZoom:.1,style:{position:"absolute",height:"100%",width:"100%",overflow:"hidden"},cy:function(e){var t;e&&s.current!==e&&(s.current=e,(t=s.current).on("select","node",(function(e){e.target.addClass("selected"),e.target.outgoers("edge").addClass("selected").addClass("selected-outgoing"),e.target.incomers("edge").addClass("selected").addClass("selected-incoming")})),t.on("unselect","node",(function(e){e.target.removeClass("selected"),e.target.outgoers("edge").removeClass("selected").removeClass("selected-outgoing"),e.target.incomers("edge").removeClass("selected").removeClass("selected-incoming")})),t.on("grab","node",(function(e){e.target.addClass("grabbed"),e.target.outgoers("edge").addClass("grabbed").addClass("grabbed-outgoing"),e.target.incomers("edge").addClass("grabbed").addClass("grabbed-incoming")})),t.on("free","node",(function(e){e.target.removeClass("grabbed"),e.target.outgoers("edge").removeClass("grabbed").removeClass("grabbed-outgoing"),e.target.incomers("edge").removeClass("grabbed").removeClass("grabbed-incoming")})),t.on("mouseover","node",(function(e){var n,r=e.target.id();(null===(n=u.current)||void 0===n?void 0:n.nodeId)!==r&&(y(t),function(e,t){var n=t.popper({content:function(){return l.current||void 0},popper:{placement:"top"}});u.current={popper:n,nodeId:t.id()},t.on("position",(function(){n.update()})),e.on("pan zoom resize",(function(){n.update()})),m(t)}(t,e.target))})),t.on("mouseout","node",(function(e){var n,r=e.target.id();(null===(n=u.current)||void 0===n?void 0:n.nodeId)===r&&y(t)})))}},v.key):Object(O.jsx)(mn.a,{style:{position:"absolute",height:"100%",width:"100%"},children:Object(O.jsxs)(h.a,{children:[Object(O.jsx)(gn.a,{color:"#eee",size:85,style:{position:"relative",top:"3px"}}),Object(O.jsxs)(h.a,{direction:"column",style:{gap:"0px"},children:[Object(O.jsx)(Y.a,{style:{fontSize:"28px"},children:"Could not build graph"}),j?Object(O.jsxs)(Y.a,{style:{maxWidth:"600px",fontSize:"14px"},children:["ERROR: ".concat(j.message),Object(O.jsx)("br",{}),(null===j||void 0===j?void 0:j.helpText)||""]}):null]})]})}))]}),Object(O.jsx)(Cn,{ref:l,currentNode:b})]})},Fn=Object(c.c)(d.a).withConfig({displayName:"ProductionGraphTab__GraphContainer",componentId:"sc-1e7uaws-0"})(["position:relative;min-height:600px;min-width:800px;border:1px solid #fff;border-top-width:0px;margin:0px;padding:0px;"]);function Kn(e){return e.toLocaleString(void 0,{maximumFractionDigits:3})}var Wn=function(){var e,t=$e(),n=null===(e=t.solverResults)||void 0===e?void 0:e.report;return Object(O.jsx)(Vn,{fluid:!0,children:n?Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(b.a,{order:2,children:"Statistics"}),Object(O.jsx)(Bn,{}),Object(O.jsx)(Hn,{order:3,children:"Points Produced"}),Object(O.jsxs)(Y.a,{children:[Kn(n.pointsProduced)," per min"]}),Object(O.jsx)(Bn,{}),Object(O.jsx)(Hn,{order:3,children:"Resource Usage Score"}),Object(O.jsx)(Y.a,{children:Kn(n.resourceEfficiencyScore)}),Object(O.jsx)(Bn,{}),Object(O.jsx)(Hn,{order:3,children:"Total Build Area"}),Object(O.jsxs)(Y.a,{children:[Kn(n.totalBuildArea)," m\xb2"]}),Object(O.jsx)(Bn,{}),Object(O.jsx)(Hn,{order:3,children:"Estimated Minimal Foundations"}),Object(O.jsxs)(Y.a,{children:[Kn(n.estimatedFoundations)," foundations (",Kn(8*n.estimatedFoundations)," Concrete)"]}),Object(O.jsx)(Bn,{}),Object(O.jsx)(b.a,{order:2,style:{marginTop:"30px"},children:"Power"}),Object(O.jsx)(Bn,{}),Object(O.jsx)(Hn,{order:3,children:"Manufacturing"}),Object(O.jsxs)(Y.a,{children:[Kn(n.powerUsageEstimate.production)," MW"]}),Object(O.jsx)(Bn,{}),Object(O.jsx)(Hn,{order:3,children:"Resource Extraction"}),Object(O.jsxs)(Y.a,{children:[Kn(n.powerUsageEstimate.extraction)," MW"]}),Object(O.jsx)(Bn,{}),Object(O.jsx)(Hn,{order:3,children:"Generation"}),Object(O.jsxs)(Y.a,{children:[Kn(n.powerUsageEstimate.generators)," MW"]}),Object(O.jsx)(Bn,{}),Object(O.jsxs)(Hn,{order:3,children:["Total ",n.powerUsageEstimate.total<0?"Production":"Usage"]}),Object(O.jsxs)(Y.a,{children:[Kn(Math.abs(n.powerUsageEstimate.total))," MW"]}),Object(O.jsx)(Bn,{}),Object(O.jsx)(b.a,{order:2,style:{marginTop:"30px"},children:"Buildings"}),Object(O.jsx)(Bn,{}),Object(O.jsxs)(Zt.a,{listStyleType:"none",children:[Object.entries(n.buildingsUsed).sort((function(e,t){return e[1].count>t[1].count?-1:e[1].count<t[1].count?1:0})).map((function(e){var n=Object(T.a)(e,2),r=n[0],i=n[1];return Object(O.jsxs)(Zt.a.Item,{style:{paddingBottom:"10px"},children:[Object(O.jsxs)(b.a,{order:3,style:{marginBottom:"8px"},children:[t.gameData.buildings[r].name," ",Object(O.jsxs)(Zn,{children:["x",Kn(i.count)]})]}),Object(O.jsx)(Yn,{withPadding:!0,listStyleType:"none",style:{marginBottom:"10px"},children:Object.entries(i.materialCost).sort((function(e,t){return e[1]>t[1]?-1:e[1]<t[1]?1:0})).map((function(e){var n=Object(T.a)(e,2),r=n[0],i=n[1];return Object(O.jsxs)(Zt.a.Item,{children:[Object(O.jsx)(qn,{children:t.gameData.items[r].name}),"  ",Object(O.jsxs)(Zn,{children:["x",Kn(i)]})]},r)}))})]},r)})),Object(O.jsxs)(Zt.a.Item,{children:[Object(O.jsx)(b.a,{order:3,style:{marginBottom:"8px"},children:"Total"}),Object(O.jsx)(Yn,{withPadding:!0,listStyleType:"none",children:Object.entries(n.totalMaterialCost).sort((function(e,t){return e[1]>t[1]?-1:e[1]<t[1]?1:0})).map((function(e){var n=Object(T.a)(e,2),r=n[0],i=n[1];return Object(O.jsxs)(Zt.a.Item,{children:[Object(O.jsx)(qn,{children:t.gameData.items[r].name})," ",Object(O.jsxs)(Zn,{children:["x",Kn(i)]})]},r)}))})]})]})]}):Object(O.jsxs)(h.a,{style:{height:"150px",justifyContent:"flex-start"},children:[Object(O.jsx)(gn.a,{color:"#eee",size:50}),Object(O.jsx)(Y.a,{style:{fontSize:"32px"},children:"No data available"})]})})},Vn=Object(c.c)(d.a).withConfig({displayName:"ReportTab__ReportContainer",componentId:"sc-11c463l-0"})(["padding:10px;padding-bottom:15px;"]),Bn=Object(c.c)(J.a).withConfig({displayName:"ReportTab__SDivider",componentId:"sc-11c463l-1"})(["margin:10px 0px;"]),Hn=Object(c.c)(b.a).withConfig({displayName:"ReportTab__SmallerTitle",componentId:"sc-11c463l-2"})(["font-size:19px;"]),qn=c.c.span.withConfig({displayName:"ReportTab__ItemLabel",componentId:"sc-11c463l-3"})(["font-size:17px;font-weight:bold;"]),Zn=c.c.span.withConfig({displayName:"ReportTab__Count",componentId:"sc-11c463l-4"})(["font-size:15px;margin-left:3px;"]),Yn=Object(c.c)(Zt.a).withConfig({displayName:"ReportTab__ListWithLine",componentId:"sc-11c463l-5"})(["position:relative;&::after{content:'';position:absolute;top:0px;bottom:0px;left:12px;width:3px;background:",";}"],(function(e){return e.theme.colors.background[3]})),Jn=function(e){return{"&.mantine-Tabs-tabControl":{minWidth:"200px"}}},$n=function(){var e=Object(s.d)();return Object(O.jsxs)(Ct.a,{variant:"outline",children:[Object(O.jsx)(Ct.a.Tab,{label:"Production Graph",icon:Object(O.jsx)(rn.a,{size:18}),sx:Jn,children:Object(O.jsx)(d.a,{fluid:!0,style:{padding:"0px"},children:Object(O.jsx)(Gn,{})})}),Object(O.jsx)(Ct.a.Tab,{label:"Factory Report",icon:Object(O.jsx)(an.a,{size:18}),sx:Jn,children:Object(O.jsx)(nt,{style:{paddingLeft:"10px",background:e.colors.background[0]},children:Object(O.jsx)(Wn,{})})})]})},Qn=function(){var e=pe({key:"drawer-open",defaultValue:"false"}),t=Object(T.a)(e,2),n=t[0],r=t[1];return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)($n,{}),Object(O.jsx)(ut,{open:"true"===n,onToggle:function(e){r(e?"true":"false")},children:Object(O.jsx)(tn,{})})]})},Xn=function(){var e=re(),t=F();return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(lt,{createRoot:!0,children:Object(O.jsx)($.AnimatePresence,{children:!t.gameData&&Object(O.jsxs)(er,{$bgImage:Q,initial:!1,animate:{opacity:1.5},exit:{opacity:0},transition:{duration:1,type:"tween"},children:[Object(O.jsx)(Z.a,{size:"xl"}),Object(O.jsx)(b.a,{style:{marginTop:"15px"},children:"Loading game data..."})]})})}),Object(O.jsxs)(nt,{style:{marginBottom:"25px"},children:[Object(O.jsxs)(b.a,{order:2,children:["Welcome back <Engineer ID #",e.engineerId,">"]}),Object(O.jsxs)(Y.a,{children:["This tool has been created to increase the efficiency of your work towards Project Assembly.",Object(O.jsx)("br",{}),"We hope that you will continue to be effective."]}),Object(O.jsx)(J.a,{style:{marginTop:"10px",marginBottom:"10px"}}),Object(O.jsx)(Y.a,{style:{fontSize:"13px"},children:e.ficsitTip})]}),t.gameData?Object(O.jsx)(et,{gameData:t.gameData,gameVersion:t.gameVersion,initializer:t.initializer,triggerInitialize:t.completedThisFrame,children:Object(O.jsx)(Qn,{})}):null]})},er=Object($.motion)(c.c.div.withConfig({displayName:"ProductionPlanner__LoadingOverlay",componentId:"sc-vvuzc9-0"})(["position:fixed;top:0;bottom:0;left:0;right:0;display:flex;justify-content:center;align-items:center;flex-direction:column;background:url(",");background-color:#000;z-index:9999;"],(function(e){return e.$bgImage}))),tr=function(){return Object(O.jsxs)("form",{action:"https://www.paypal.com/donate",method:"post",target:"_blank",style:{opacity:"0.8"},children:[Object(O.jsx)("input",{type:"hidden",name:"business",value:"EN9ZT88D25SRS"}),Object(O.jsx)("input",{type:"hidden",name:"no_recurring",value:"1"}),Object(O.jsx)("input",{type:"hidden",name:"item_name",value:"Wow, I didn't expect anyone to click this button! It honestly means a lot! I will put this money towards a nice coffee :P"}),Object(O.jsx)("input",{type:"hidden",name:"currency_code",value:"USD"}),Object(O.jsx)("input",{type:"image",src:"https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif",name:"submit",title:"PayPal - The safer, easier way to pay online!",alt:"Donate with PayPal button"}),Object(O.jsx)("img",{alt:"",src:"https://www.paypal.com/en_US/i/scr/pixel.gif",width:"1",height:"1"})]})},nr=function(e){return Object(O.jsx)(j.a,Object(_.a)({target:"_blank",rel:"noopener noreferrer"},e))},rr=function(e){Object(Oe.a)(n,e);var t=Object(xe.a)(n);function n(e){var r;return Object(me.a)(this,n),(r=t.call(this,e)).state={hasError:!1},r}return Object(ge.a)(n,[{key:"componentDidCatch",value:function(){}},{key:"render",value:function(){return this.state.hasError?Object(O.jsxs)(nt,{children:[Object(O.jsx)(b.a,{children:"Oh no..."}),Object(O.jsxs)(Y.a,{children:["Something broke horribly... Sorry about that, but that's why it says BETA at the top :P",Object(O.jsx)("br",{}),"If you don't mind, you can ",Object(O.jsx)(nr,{href:"https://github.com/lydianlights/yet-another-factory-planner/issues",children:"file an issue on github"})," or ",Object(O.jsx)(nr,{href:"https://discord.gg/p7e9ZzRHCm",children:"contact me on discord"})," letting me know what you were doing, that way I can fix this crash.",Object(O.jsx)("br",{}),"In the meantime, refreshing the page should reset everything and let you get back to work :D"]})]}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(){return{hasError:!0}}}]),n}(i.a.Component),ir=function(){var e=Object(s.d)();return Object(O.jsx)(l.a,{padding:"md",header:Object(O.jsx)(ar,{height:e.other.headerHeight,children:Object(O.jsx)(W,{})}),children:Object(O.jsxs)(or,{fluid:!0,children:[Object(O.jsx)(rr,{children:Object(O.jsx)(Xn,{})}),Object(O.jsxs)(cr,{children:[Object(O.jsxs)(sr,{children:["Made with \u2665 by ",Object(O.jsx)(nr,{href:"https://github.com/lydianlights",children:"LydianLights"})," - Questions or bugs? File an ",Object(O.jsx)(nr,{href:"https://github.com/lydianlights/yet-another-factory-planner/issues",children:"issue on github"})," or ",Object(O.jsx)(nr,{href:"https://discord.gg/p7e9ZzRHCm",children:"check out the discord"})]}),Object(O.jsx)(tr,{})]})]})})},ar=Object(c.c)(u.a).withConfig({displayName:"Main__SHeader",componentId:"sc-2t46ci-0"})(["position:fixed;margin:0px;padding:10px;background:",";overflow:hidden;"],(function(e){return e.theme.colors.primary[6]})),or=Object(c.c)(d.a).withConfig({displayName:"Main__MainContainer",componentId:"sc-2t46ci-1"})(["margin-left:",";margin-top:",";padding-left:0px;"],(function(e){return e.theme.other.pageLeftMargin}),(function(e){return e.theme.other.headerHeight})),cr=Object(c.c)(d.a).withConfig({displayName:"Main__Footer",componentId:"sc-2t46ci-2"})(["margin-top:40px;margin-bottom:20px;display:flex;flex-direction:column;justify-content:center;align-items:center;"]),sr=Object(c.c)(d.a).withConfig({displayName:"Main__FooterContent",componentId:"sc-2t46ci-3"})(["padding:10px 20px;color:",";"],(function(e){return e.theme.white})),lr=Object(c.b)(["body{margin:0;padding:0;font-family:",";background:url(",");}#root{min-height:100vh;}html,.custom-scrollbar{scrollbar-color:",";& > *{scrollbar-color:initial;}::-webkit-scrollbar{width:auto;}::-webkit-scrollbar-track{background-color:",";}::-webkit-scrollbar-thumb{background-color:",";}::-webkit-scrollbar-corner{background-color:",";}::-webkit-scrollbar-button:single-button{background-color:",';display:block;height:auto;width:auto;background-size:10px;background-repeat:no-repeat;background-position:center center;}::-webkit-scrollbar-button:single-button:vertical:decrement{background-image:url("data:image/svg+xml;base64,','");}::-webkit-scrollbar-button:single-button:vertical:increment{background-image:url("data:image/svg+xml;base64,','");}::-webkit-scrollbar-button:single-button:horizontal:decrement{background-image:url("data:image/svg+xml;base64,','");}::-webkit-scrollbar-button:single-button:horizontal:increment{background-image:url("data:image/svg+xml;base64,','");}}'],(function(e){return e.theme.fontFamily}),Q,(function(e){var t=e.theme;return"".concat(t.other.scrollbarThumbColor," ").concat(t.other.scrollbarTrackColor)}),(function(e){return e.theme.other.scrollbarTrackColor}),(function(e){return e.theme.other.scrollbarThumbColor}),(function(e){return e.theme.other.scrollbarTrackColor}),(function(e){return e.theme.other.scrollbarTrackColor}),btoa('<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" fill="#eee"><polygon points="50,20 100,75 0,75 Z"/></svg>'),btoa('<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" fill="#eee"><polygon points="50,75 100,20 0,20 Z"/></svg>'),btoa('<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" fill="#eee"><polygon points="20,50 75,100 75,0 Z"/></svg>'),btoa('<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" fill="#eee"><polygon points="75,50 20,100 20,0 Z"/></svg>'));var ur=function(){return Object(O.jsx)(s.a,{theme:wn,styles:In,children:Object(O.jsx)(dr,{})})},dr=function(){var e=Object(s.d)();return Object(O.jsxs)(c.a,{theme:e,children:[Object(O.jsx)(lr,{}),Object(O.jsx)(ct,{children:Object(O.jsx)(oe,{children:Object(O.jsx)(K,{children:Object(O.jsx)(ir,{})})})})]})};o.a.render(Object(O.jsx)(ur,{}),document.getElementById("root"))}},[[194,1,2]]]);
//# sourceMappingURL=main.3498de6b.chunk.js.map